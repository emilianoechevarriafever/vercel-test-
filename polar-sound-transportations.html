<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/png" sizes="32x32" href="./favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./favicons/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="./favicons/apple-touch-icon.png">
  <link rel="shortcut icon" href="./favicon.ico">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Occident - Polar Sound 2026: Transport</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
    html { scroll-behavior: smooth; -webkit-tap-highlight-color: transparent; }
    :root {
      --color-primary: #0079ca;
      --color-primary-weak: #E6F4FF;
      --color-text: #031419;
      --color-text-subtle: #536b75;
      --color-text-disable: #b0b8bf;
      --color-border: #ccd2d8;
      --color-border-light: #ccd2d8;
      --color-bg: #ffffff;
      --color-bg-neutral: #f2f3f3;
      --font: 'Montserrat', sans-serif;
    }
    body { font-family:var(--font); background:var(--color-bg-neutral); display:flex; justify-content:center; color:var(--color-text); overflow-x:hidden; }
    .phone { width:393px; max-width:100vw; background:var(--color-bg); min-height:100vh; position:relative; }

    .sticky-header { position:sticky; top:0; z-index:100; background:#fff; }
    .navbar { display:flex; align-items:center; justify-content:space-between; padding:10px 16px; background:#fff; border-top:none; border-bottom:1px solid #ccd2d8; }
    .navbar .logo-link { text-decoration:none; display:flex; align-items:center; }
    .navbar .logo-link img { height:38px; width:auto; display:block; object-fit:contain; }
    .nav-icons { display:flex; align-items:center; gap:20px; }
    .nav-icons svg { height:24px; width:auto; color:var(--color-text); cursor:pointer; }
    .nav-icon-btn{all:unset;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;color:inherit;width:24px;height:24px;flex-shrink:0;box-sizing:border-box;overflow:visible}
    .nav-icon-btn svg { height:24px; width:auto; color:var(--color-text); }
    .avatar-wrap{all:unset;position:relative;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;width:24px;height:24px;flex-shrink:0;box-sizing:border-box}
    .avatar-wrap img { width:24px; height:24px; border-radius:50%; object-fit:cover; display:none;}
    .avatar-wrap .avatar-placeholder { display:flex;}
    html.u-in .avatar-wrap::after { content:''; position:absolute; top:-1px; right:-1px; width:8px; height:8px; background:#22ad5c; border:1.5px solid white; border-radius:50%; }
    html.u-in .avatar-wrap img{display:block}
    html.u-in .avatar-wrap .avatar-placeholder{display:none}
    .hero { position:relative; width:100%; height:390px; overflow:hidden; }
    .hero img.hero-bg, .hero video.hero-bg { width:100%; height:100%; object-fit:cover; position:absolute; inset:0; }
    .hero img.hero-bg { z-index:0; }
    .hero video.hero-bg { z-index:1; }
    .hero .overlay { position:absolute; inset:0; background:linear-gradient(180deg, rgba(6,35,44,0.3) 0%, rgba(6,35,44,0.6) 100%); display:flex; flex-direction:column; align-items:center; justify-content:center; gap:8px; pointer-events:none; }
    .hero .overlay .brand-text { font-family:var(--font); font-size:32px; font-weight: 600; color:white; letter-spacing:4px; text-transform:uppercase; text-shadow:0 2px 20px rgba(0,0,0,0.5); }
    .hero .overlay .brand-sub { font-family:var(--font); font-size:14px; font-weight:600; color:rgba(255,255,255,0.9); letter-spacing:2px; }
    .hero .side-buttons { position:absolute; top:16px; right:16px; display:flex; flex-direction:column; gap:12px; z-index:2; }
    .hero .side-btn { width:40px; height:40px; background:white; border:1px solid rgba(0,0,0,0.1); border-radius:50%; display:flex; align-items:center; justify-content:center; box-shadow:0 2px 4px rgba(0,0,0,0.12); cursor:pointer; }
    .hero .side-btn svg { width:20px; height:20px; color:var(--color-text); }
    .hero .side-btn.liked svg { fill:#FF3B30; stroke:#FF3B30; color:#FF3B30; }
    .hero .shadow-overlay { position:absolute; bottom:0; left:0; right:0; height:135px; background:linear-gradient(to bottom, rgba(0,0,0,0) 0%, rgba(0,0,0,0.32) 96%); display:flex; flex-direction:column; justify-content:flex-end; align-items:flex-end; padding:0 16px 16px; gap:16px; z-index:2; }
    .hero .gallery-btn { display:inline-flex; align-items:center; gap:4px; background:#fff; border:none; border-radius:4rem; padding:0 12px; height:32px; font-family:var(--font); font-weight:600; font-size:14px; line-height:20px; cursor:pointer; color:#031419; pointer-events:auto; box-shadow:0 3px 3px rgba(0,70,121,0.2); }
    .hero .gallery-btn svg { width:16px; height:16px; }
    .hero .slide-indicators { display:flex; gap:4px; width:100%; }
    /* Barras horizontales (Figma), no círculos */
    .hero .slide-indicators .bar { flex:1; min-width:0; height:3px; border-radius:64px; background:rgba(255,255,255,0.5); }
    .hero .slide-indicators .bar.active { background:white; }
    .hero .rounded-top { position:absolute; bottom:0; left:0; right:0; height:8px; background:white; border-radius:8px 8px 0 0; z-index:2; }

    .title-section { padding:16px; }
    .tag-selling { display:inline-flex; align-items:center; min-height:20px; padding:4px 12px; background:#df7b00; border-radius:4px; font-size:12px; font-weight:400; margin-bottom:12px; }
    .title-section h1 { font-size:20px; font-weight:600; line-height:28px; margin-bottom:4px; }
    .divider { height:1px; background:var(--color-border); margin:0 16px; }

    .description { padding: 24px 16px; font-size:14px; line-height:20px; }
    .description p { margin-bottom:12px; }

    .section-header { display:flex; align-items:center; gap:8px; padding:16px; border-bottom:1px solid var(--color-border); }
    .section-header svg { width:24px; height:24px; flex-shrink:0; color:var(--color-text); }
    .section-header h2 { font-size:20px; font-weight: 600; line-height:24px; flex:1; }

    .transport-options { padding:0 16px 16px; border-bottom:1px solid var(--color-border); }
    #transport-rows { margin-top:12px; }
    .ticket-row { --ticket-border:#ccd2d8; display:flex; align-items:stretch; min-height:92px; margin-bottom:16px; position:relative; border-radius:8px; overflow:visible; background:transparent; }
    .ticket-row::after { content:''; position:absolute; right:136px; top:8px; bottom:8px; width:1px; background-image:repeating-linear-gradient(to bottom, var(--ticket-border) 0 2px, transparent 2px 4px); background-repeat:no-repeat; background-size:1px 100%; transform:translateX(50%); pointer-events:none; z-index:2; }
    .ticket-row .ticket-content { flex:1; padding:12px; display:flex; flex-direction:column; gap:6px; border:1px solid var(--ticket-border); border-right:none; border-radius:8px 0 0 8px; background:#fff; min-height:92px; }
    .ticket-row .ticket-name { font-size:14px; font-weight:600; line-height:18px; color:var(--color-text); }
    .ticket-row .ticket-detail { font-size:12px; color:var(--color-text-subtle); }
    .ticket-row .ticket-price { font-size:14px; font-weight:600; color:var(--color-text); margin-top:auto; }
    .ticket-row .ticket-more,
    .ticket-row .ticket-info-toggle { font-size:12px; font-weight:600; line-height:16px; color:#0079ca; text-decoration:none; padding:2px 0; cursor:pointer; background:none; border:none; font-family:var(--font); text-align:left; align-self:flex-start; }
    .ticket-row .ticket-info-detail { display:none; margin-top:8px; padding-top:6px; border-top:1px solid #ccd2d8; font-size:14px; line-height:20px; color:var(--color-text); }
    .ticket-row.ticket-info-expanded .ticket-info-detail { display:block; }
    .ticket-row.ticket-info-expanded .ticket-content { justify-content:flex-start; }
    .ticket-row .ticket-selector-right { width:136px; flex-shrink:0; display:flex; align-items:center; justify-content:center; padding:12px; border:1px solid var(--ticket-border); border-left:none; border-radius:0 8px 8px 0; background:#fff; position:relative; }
    .ticket-row .stepper { display:flex; align-items:center; gap:4px; padding:0; background:transparent; border:none; }
    .ticket-amount .amt-btn { width:32px; height:32px; border-radius:50%; border:none; display:flex; align-items:center; justify-content:center; cursor:pointer; font-size:18px; font-weight:400; transition:background 0.15s, color 0.15s; background:#f2f3f3; color:#a7b2ba; }
    .ticket-amount .amt-count { width:36px; text-align:center; font-size:16px; font-weight:600; line-height:20px; color:#031419; }
    .ticket-row .amt-btn.plus { background:#e6f4ff; color:#0079ca; }
    .ticket-row.qty-zero .amt-btn.minus { background:#f2f3f3; color:#a7b2ba; cursor:default; }
    .ticket-row.qty-zero .amt-count { color:#a7b2ba; }
    .ticket-row.qty-zero .amt-btn.plus { background:#e6f4ff; color:#0079ca; }
    .ticket-row.selected { --ticket-border:#0079ca; }
    .ticket-row.selected .ticket-selector-right { background:#e6f4ff; border-radius:0 8px 8px 0; }
    .ticket-row.selected .stepper { background:#fff; border-radius:64px; padding:4px 6px; }
    .ticket-row.selected .amt-btn { background:#e6f4ff; color:#0079ca; }
    .ticket-row.selected .amt-btn.plus { background:#e6f4ff; color:#0079ca; }
    .ticket-row .ticket-notch { position:absolute; right:136px; top:0; bottom:0; width:16px; pointer-events:none; z-index:3; transform: translateX(50%); }
    .ticket-row .ticket-notch::before,
    .ticket-row .ticket-notch::after { content:''; position:absolute; left:0; width:16px; height:8px; background:var(--color-bg); box-sizing:border-box; }
    .ticket-row .ticket-notch::before { top:0; border:1px solid var(--ticket-border); border-top:none; border-radius:0 0 8px 8px; }
    .ticket-row .ticket-notch::after { bottom:0; border:1px solid var(--ticket-border); border-bottom:none; border-radius:8px 8px 0 0; }

    .help-section { padding:16px; border-top:1px solid var(--color-border); border-bottom:1px solid var(--color-border); display:flex; align-items:center; justify-content:space-between; }
    .help-section span { font-size:14px; font-weight:500; }
    .help-section a { font-size:14px; font-weight:600; color:var(--color-primary); text-decoration:none; }

    .description .subtitle { font-weight:600; font-size:16px; margin-bottom:8px; margin-top:16px; }
    .description ul { padding-left:20px; margin-bottom:12px; }
    .description ul li { margin-bottom:4px; }
    .description a { color:var(--color-primary); text-decoration:underline; pointer-events:none; cursor:default; }

    .venue-section { padding: 24px 16px; }
    .venue-section .venue-img { width:100%; height:200px; border-radius:8px; object-fit:cover; margin-bottom:12px; }
    .venue-section .venue-name-lg { font-size:16px; font-weight:600; margin-bottom:8px; }
    .venue-section .venue-desc { font-size:14px; line-height:20px; color:var(--color-text-subtle); }

    .location { padding: 24px 16px; }
    .location .loc-name { font-weight:600; font-size:14px; margin-bottom:4px; }
    .location .loc-address { font-size:14px; color:var(--color-text-subtle); margin-bottom:12px; }
    .location .map-placeholder { width:100%; height:160px; background:#e8e8e8; border-radius:8px; overflow:hidden; }
    .location .map-placeholder img { width:100%; height:100%; object-fit:cover; }

    .footer { background:#031419; color:white; padding:32px 16px 80px; }
    .footer-cols { display:flex; justify-content:space-between; margin-bottom:24px; }
    .footer-col h5 { font-size:14px; font-weight: 600; margin-bottom:8px; }
    .footer-col ul { list-style:none; }
    .footer-col ul li { font-size:14px; line-height:20px; margin-bottom:4px; }
    .footer-col ul li a { color:rgba(255,255,255,0.75); text-decoration:none; transition:color 0.15s; }
    .footer-col ul li a:hover { color:white; }
    .footer .legal { border-top:1px solid rgba(255,255,255,0.15); padding-top:16px; font-size:12px; color:rgba(255,255,255,0.5); }
    .footer .legal a { color:white; }

    .sticky-cta { position:fixed; bottom:0; width:393px; max-width:100vw; z-index:200; background:transparent; padding:12px 16px max(12px, env(safe-area-inset-bottom)); }
    .sticky-cta .cta-btn { width:100%; height:48px; background:#0079ca; border:2px solid transparent; border-radius:64px; color:#fff; font-family:var(--font); font-weight:600; font-size:16px; line-height:24px; cursor:pointer; transition:background 0.2s, border-color 0.2s, box-shadow 0.2s, color 0.2s, opacity 0.2s; outline:none; }
    .sticky-cta .cta-btn:hover { background:#0079ca; }
    .sticky-cta .cta-btn:focus-visible { border-color:#005795; box-shadow:0 0 0 4px rgba(0,121,202,0.32); }
    .sticky-cta .cta-btn:active { background:#0079ca; opacity:0.85; }
    .sticky-cta .cta-btn:disabled, .sticky-cta .cta-btn.disabled { background:#f2f3f3; color:#a7b2ba; border-color:transparent; box-shadow:none; cursor:default; opacity:1; }

    /* Flow stepper — Figma Progress Indicator */
    .flow-stepper { display:flex; align-items:flex-start; justify-content:space-between; padding:12px 16px; background:#fff; border-bottom:1px solid var(--color-border); }
    .flow-stepper .step { display:flex; flex-direction:column; align-items:center; gap:4px; flex:1; min-width:0; position:relative; }
    .flow-stepper .step::after { content:''; position:absolute; top:9px; left:50%; width:100%; height:2px; background:#ccd2d8; z-index:0; }
    .flow-stepper .step:last-child::after { display:none; }
    .flow-stepper .step.done::after { background:#0089e3; }
    .flow-stepper .step.current::after { background:#ccd2d8; }
    .flow-stepper .step .dot { width:20px; height:20px; border-radius:50%; border:2px solid #ccd2d8; background:#fff; display:flex; align-items:center; justify-content:center; z-index:1; position:relative; font-size:0; color:transparent; box-sizing:border-box; }
    .flow-stepper .step.done .dot { border-color:#0089e3; background:#fff; }
    .flow-stepper .step.done .dot::before { content:''; display:block; width:10px; height:7px; background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 11 8' fill='none'%3E%3Cpath d='M1 3.5L4 6.5L10 1' stroke='%230089e3' stroke-width='1.8' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E") center/contain no-repeat; }
    .flow-stepper .step.done.skipped .dot { border-color:#0089e3; }
    .flow-stepper .step.done.skipped .dot::before { width:8px; height:2px; background:#0089e3; border-radius:1px; }
    .flow-stepper .step.current .dot { border-color:#0089e3; background:#fff; }
    .flow-stepper .step.current .dot::before { content:''; display:block; width:10px; height:10px; border-radius:50%; background:#0089e3; }
    .flow-stepper .step .label { font-family:var(--font); font-size:12px; font-weight:600; line-height:16px; color:#a7b2ba; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:100%; }
    .flow-stepper .step.done .label { color:#536b75; }
    .flow-stepper .step.current .label { color:#536b75; }
    .flow-stepper a.step { text-decoration:none; color:inherit; cursor:pointer; }
    .flow-stepper a.step.disabled { pointer-events:none; cursor:default; opacity:0.45; }
    .flow-stepper.stepper-hidden { display:none !important; }

    /* Cross-sell bottom sheet (Option H) */
    .crosssell-overlay { position:fixed; inset:0; background:rgba(3,20,25,0.35); opacity:0; pointer-events:none; transition:opacity 0.2s ease; z-index:350; }
    .crosssell-overlay.open { opacity:1; pointer-events:auto; }
    .crosssell-sheet { position:fixed; left:50%; bottom:0; transform:translateX(-50%) translateY(100%); width:393px; max-width:100vw; background:#fff; border-radius:16px 16px 0 0; z-index:351; padding:16px; transition:transform 0.3s ease; box-shadow:0 -4px 20px rgba(0,0,0,0.12); }
    .crosssell-sheet.open { transform:translateX(-50%) translateY(0); }
    .crosssell-sheet .handle { width:36px; height:4px; border-radius:4px; background:#d7dde2; margin:0 auto 14px; }
    .crosssell-sheet h3 { font-size:18px; font-weight: 600; text-align:center; margin-bottom:16px; }
    .crosssell-sheet .hub-actions { display:flex; flex-direction:column; gap:8px; }
    .crosssell-sheet .hub-btn { width:100%; min-height:44px; border-radius:64px; border:1px solid #ccd2d8; background:#fff; color:var(--color-text); font-family:var(--font); font-size:14px; font-weight:600; cursor:pointer; padding:10px 16px; }
    .crosssell-sheet .hub-btn.primary { background:#0079ca; border-color:#0079ca; color:#fff; }
    .crosssell-sheet .hub-btn.secondary { background:#fff; border-color:#ccd2d8; color:var(--color-text); display:inline-flex; align-items:center; justify-content:center; gap:8px; }
    .crosssell-sheet .hub-btn.secondary svg { width:20px; height:20px; flex-shrink:0; stroke:currentColor; fill:none; stroke-width:2; }

    /* === FULLSCREEN GALLERY === */
    .fs-gallery { position:fixed; inset:0; z-index:9999; background:#fff; display:none; flex-direction:column; }
    .fs-gallery.open { display:flex; }
    .fs-gallery-topbar { position:absolute; top:0; right:0; z-index:2; padding:12px 16px; }
    .fs-gallery-close { width:40px; height:40px; border:none; background:transparent; cursor:pointer; display:flex; align-items:center; justify-content:center; }
    .fs-gallery-close svg { width:28px; height:28px; color:#031419; }
    .fs-gallery-viewport { flex:1; position:relative; overflow:hidden; display:flex; align-items:center; }
    .fs-gallery-track { display:flex; height:100%; width:100%; transition:transform 0.3s cubic-bezier(.4,0,.2,1); }
    .fs-gallery-track.no-transition { transition:none; }
    .fs-gallery-slide { min-width:100%; height:100%; display:flex; align-items:center; justify-content:center; }
    .fs-gallery-slide img { max-width:100%; max-height:100%; object-fit:contain; user-select:none; -webkit-user-drag:none; border-radius:4px; }
    .fs-gallery-arrow { position:absolute; top:50%; transform:translateY(-50%); z-index:2; width:44px; height:44px; border:none; background:rgba(0,0,0,0.3); border-radius:8px; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:background 0.2s; }
    .fs-gallery-arrow:active { background:rgba(0,0,0,0.45); }
    .fs-gallery-arrow svg { width:28px; height:28px; color:#fff; }
    .fs-gallery-arrow.prev { left:8px; }
    .fs-gallery-arrow.next { right:8px; }
    .fs-gallery-thumbs { display:flex; gap:8px; padding:12px 16px max(16px, env(safe-area-inset-bottom)); flex-shrink:0; overflow-x:auto; -webkit-overflow-scrolling:touch; scrollbar-width:none; }
    .fs-gallery-thumbs::-webkit-scrollbar { display:none; }
    .fs-gallery-thumb { width:72px; height:72px; min-width:72px; border-radius:8px; overflow:hidden; cursor:pointer; border:2px solid transparent; transition:border-color 0.2s; }
    .fs-gallery-thumb.active { border-color:#0079ca; }
    .fs-gallery-thumb img { width:100%; height:100%; object-fit:cover; }

    @media (max-width:393px) { .phone { width:100vw; } .sticky-cta { width:100vw; } .crosssell-sheet { width:100vw; } }
    /* Focus-visible */
    button:focus-visible, a:focus-visible { outline: 2px solid #0079ca; outline-offset: 2px; }
    /* Tap feedback */
    .nav-icon-btn:active { opacity:0.6; }
    .ticket-pill:active { transform:scale(0.96); }
  </style>
  <link rel="stylesheet" href="css/navbar.css">
<script>if(localStorage.getItem("fever_logged_in")==="true")document.documentElement.classList.add("u-in")</script>
</head>
<body>
  <div class="phone">

    <header class="sticky-header">
    <nav class="navbar">
      <a href="home.html" id="nav-logo" class="logo-link"><img id="nav-logo-img" src="img/fever-logo.svg" alt="Fever"></a>
      <div class="nav-icons">
        <a class="nav-icon-btn" href="search.html" aria-label="Search"><svg viewBox="0 0 512 512" fill="currentColor"><path d="M384 208A176 176 0 1 0 32 208a176 176 0 1 0 352 0zM343.3 366C307 397.2 259.7 416 208 416C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208c0 51.7-18.8 99-50 135.3L507.3 484.7c6.2 6.2 6.2 16.4 0 22.6s-16.4 6.2-22.6 0L343.3 366z"/></svg></a>
        <a class="nav-icon-btn" href="home.html" aria-label="Location"><svg viewBox="0 0 384 512" fill="currentColor"><path d="M352 192c0-88.4-71.6-160-160-160S32 103.6 32 192c0 15.6 5.4 37 16.6 63.4c10.9 25.9 26.2 54 43.6 82.1c34.1 55.3 74.4 108.2 99.9 140c25.4-31.8 65.8-84.7 99.9-140c17.3-28.1 32.7-56.3 43.6-82.1C346.6 229 352 207.6 352 192zm32 0c0 87.4-117 243-168.3 307.2c-12.3 15.3-35.1 15.3-47.4 0C117 435 0 279.4 0 192C0 86 86 0 192 0S384 86 384 192zm-240 0a48 48 0 1 0 96 0 48 48 0 1 0 -96 0zm48 80a80 80 0 1 1 0-160 80 80 0 1 1 0 160z"/></svg></a>
        <a class="nav-icon-btn" href="favorites.html" aria-label="Favorites"><svg viewBox="0 0 512 512" fill="currentColor"><path d="M244 130.6l-12-13.5-4.2-4.7c-26-29.2-65.3-42.8-103.8-35.8c-53.3 9.7-92 56.1-92 110.3v3.5c0 32.3 13.4 63.1 37.1 85.1L253 446.8c.8 .7 1.9 1.2 3 1.2s2.2-.4 3-1.2L443 275.5c23.6-22 37-52.8 37-85.1v-3.5c0-54.2-38.7-100.6-92-110.3c-38.5-7-77.8 6.6-103.8 35.8l-4.2 4.7-12 13.5c-3 3.4-7.4 5.4-12 5.4s-8.9-2-12-5.4zm34.9-57.1C311 48.4 352.7 37.7 393.7 45.1C462.2 57.6 512 117.3 512 186.9v3.5c0 36-13.1 70.6-36.6 97.5c-3.4 3.8-6.9 7.5-10.7 11l-184 171.3c-.8 .8-1.7 1.5-2.6 2.2c-6.3 4.9-14.1 7.5-22.1 7.5c-9.2 0-18-3.5-24.8-9.7L47.2 299c-3.8-3.5-7.3-7.2-10.7-11C13.1 261 0 226.4 0 190.4v-3.5C0 117.3 49.8 57.6 118.3 45.1c40.9-7.4 82.6 3.2 114.7 28.4c6.7 5.3 13 11.1 18.7 17.6l4.2 4.7 4.2-4.7c4.2-4.7 8.6-9.1 13.3-13.1c1.8-1.5 3.6-3 5.4-4.5z"/></svg></a>
        <a class="avatar-wrap" href="login.html" aria-label="Profile"><img src="img/profile-avatar.png" alt="Profile"><svg class="avatar-placeholder" viewBox="0 0 512 512" fill="#536B75"><path d="M406.5 399.6C387.4 352.9 341.5 320 288 320l-64 0c-53.5 0-99.4 32.9-118.5 79.6C69.9 362.2 48 311.7 48 256C48 141.1 141.1 48 256 48s208 93.1 208 208c0 55.7-21.9 106.2-57.5 143.6zm-40.1 32.7C334.4 452.4 296.6 464 256 464s-78.4-11.6-110.5-31.7c7.3-36.7 39.7-64.3 78.5-64.3l64 0c38.8 0 71.2 27.6 78.5 64.3zM256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-272a40 40 0 1 1 0-80 40 40 0 1 1 0 80zm-64-40a64 64 0 1 0 128 0 64 64 0 1 0-128 0z"/></svg></a>
<a class="nav-icon-btn" href="category.html" aria-label="Menu"><svg viewBox="0 0 448 512" fill="currentColor"><path d="M0 80c0-8.8 7.2-16 16-16H432c8.8 0 16 7.2 16 16s-7.2 16-16 16H16C7.2 96 0 88.8 0 80zM0 240c0-8.8 7.2-16 16-16H432c8.8 0 16 7.2 16 16s-7.2 16-16 16H16c-8.8 0-16-7.2-16-16zM448 400c0 8.8-7.2 16-16 16H16c-8.8 0-16-7.2-16-16s7.2-16 16-16H432c8.8 0 16 7.2 16 16z"/></svg></a>
      </div>
    </nav>
    <div class="flow-stepper" id="flow-stepper">
      <a href="javascript:void(0)" id="step1" class="step done"><span class="dot"></span><span class="label">Tickets</span></a>
      <a href="javascript:void(0)" id="step2" class="step done"><span class="dot"></span><span class="label">Hotel</span></a>
      <div class="step current"><span class="dot">3</span><span class="label">Transport</span></div>
      <a href="javascript:void(0)" id="step4" class="step"><span class="dot">4</span><span class="label" id="step4-label">Checkout</span></a>
    </div>
    </header>

    <div class="hero">
      <img class="hero-bg" id="hero-img" src="img/polar-sound-hero.png" alt="Transport to festival">
      <video class="hero-bg" src="https://applications-media.feverup.com/video/upload/f_auto,w_900,h_500,c_fill/fever2/plan/video/6a2a83fa-f50b-11ef-a02f-7a56ddf7cf04.mp4" poster="https://applications-media.feverup.com/image/upload/f_auto,w_900,h_500,c_fill/fever2/plan/photo/e65a2dd4-a33c-11ef-8f62-322be0a410d7.jpg" autoplay muted loop playsinline></video>
      <div class="overlay">
        <div class="brand-text">POLAR SOUND</div>
        <div class="brand-sub">&#10070;</div>
      </div>
      <div class="side-buttons">
        <button type="button" class="side-btn" aria-label="Like"><svg viewBox="0 0 512 512" fill="currentColor"><path d="M244 130.6l-12-13.5-4.2-4.7c-26-29.2-65.3-42.8-103.8-35.8c-53.3 9.7-92 56.1-92 110.3v3.5c0 32.3 13.4 63.1 37.1 85.1L253 446.8c.8 .7 1.9 1.2 3 1.2s2.2-.4 3-1.2L443 275.5c23.6-22 37-52.8 37-85.1v-3.5c0-54.2-38.7-100.6-92-110.3c-38.5-7-77.8 6.6-103.8 35.8l-4.2 4.7-12 13.5c-3 3.4-7.4 5.4-12 5.4s-8.9-2-12-5.4zm34.9-57.1C311 48.4 352.7 37.7 393.7 45.1C462.2 57.6 512 117.3 512 186.9v3.5c0 36-13.1 70.6-36.6 97.5c-3.4 3.8-6.9 7.5-10.7 11l-184 171.3c-.8 .8-1.7 1.5-2.6 2.2c-6.3 4.9-14.1 7.5-22.1 7.5c-9.2 0-18-3.5-24.8-9.7L47.2 299c-3.8-3.5-7.3-7.2-10.7-11C13.1 261 0 226.4 0 190.4v-3.5C0 117.3 49.8 57.6 118.3 45.1c40.9-7.4 82.6 3.2 114.7 28.4c6.7 5.3 13 11.1 18.7 17.6l4.2 4.7 4.2-4.7c4.2-4.7 8.6-9.1 13.3-13.1c1.8-1.5 3.6-3 5.4-4.5z"/></svg></button>
        <button type="button" class="side-btn" aria-label="Share"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8M16 6l-4-4-4 4M12 2v13"/></svg></button>
      </div>
      <div class="shadow-overlay">
        <button type="button" class="gallery-btn"><svg viewBox="0 0 512 512" fill="currentColor"><path d="M224 80c0-26.5-21.5-48-48-48H80C53.5 32 32 53.5 32 80v96c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48V80zm0 256c0-26.5-21.5-48-48-48H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48V336zM288 80v96c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48H336c-26.5 0-48 21.5-48 48zM480 336c0-26.5-21.5-48-48-48H336c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48V336z"/></svg>Gallery</button>
        <div class="slide-indicators">
          <div class="bar active"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
        </div>
      </div>
      <div class="rounded-top"></div>
    </div>

    <div class="title-section">
      <div class="tag-selling">Tickets Selling Fast</div>
      <h1>Occident - Polar Sound 2026: Transport</h1>
    </div>
    <div class="divider"></div>
    <div class="description">
      <p>&#128652; Add round-trip transport to Baqueira Beret from main cities. Buses and shuttles drop you at the festival parking lot. You can also skip and arrange your own transport.</p>
    </div>
    <div class="divider"></div>

    <div class="section-header" id="transport-section">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M5 17h14v-5H5v5zM5 8h3l2-3h4l2 3h3v9H5V8z"/><circle cx="7.5" cy="16.5" r="1.5"/><circle cx="16.5" cy="16.5" r="1.5"/></svg>
      <h2>Transport options</h2>
    </div>
    <div class="transport-options">
      <div id="transport-rows"></div>
    </div>

    <div class="help-section">
      <span>Need help?</span>
      <a href="javascript:void(0)">Contact Support here</a>
    </div>

    <!-- General Info -->
    <div id="general-info-block">
    <div class="section-header">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
      <h2>General info</h2>
    </div>
    <div class="description">
      <p>&#128652; <strong>Transport to Polar Sound 2026</strong> &mdash; Get to Baqueira Beret hassle-free with our official festival transport options. All services include round-trip transfers with direct drop-off at the festival parking lot.</p>
      <p class="subtitle">What's included</p>
      <ul>
        <li>Round-trip bus or shuttle transfer to Baqueira Beret</li>
        <li>Assigned seating on board</li>
        <li>Luggage compartment (1 large bag + 1 carry-on per passenger)</li>
        <li>Drop-off and pick-up at the festival parking lot entrance</li>
      </ul>
      <p class="subtitle">Important information</p>
      <ul>
        <li>&#128197; Buses depart on Friday 12 Mar (evening) and return Sunday 14 Mar (afternoon)</li>
        <li>&#9201; Please arrive at the meeting point at least 30 minutes before scheduled departure</li>
        <li>&#128205; Exact meeting points will be communicated via email 48 hours before departure</li>
        <li>&#10060; Cancellations accepted up to 7 days before departure for a full refund</li>
        <li>&#128664; Vielha shuttle runs multiple daily departures during the festival</li>
      </ul>
      <p class="subtitle">Don't need transport?</p>
      <p>No problem! You can skip this step and arrange your own transport to Baqueira Beret. The festival parking lot is located at the Baqueira Beret - Sector Bonaigua resort (coordinates: 42.6946&deg;N, 0.9541&deg;E). Free parking is available on a first-come, first-served basis.</p>
    </div>
    <div class="divider"></div>
    </div>

    <!-- About the Venue -->
    <div class="section-header">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3 21h18M5 21V7l7-4 7 4v14M9 21v-6h6v6"/></svg>
      <h2>About the venue</h2>
    </div>
    <div class="venue-section">
      <img class="venue-img" src="https://applications-media.feverup.com/image/upload/f_auto,w_720,h_720/fever2/plan/photo/faa6345e-8734-11f0-b74b-c6d9e9977cc8.jpg" alt="Baqueira Beret">
      <div class="venue-name-lg">Baqueira Beret Ski Resort</div>
      <div class="venue-desc">The Baqueira Beret - Sector Bonaigua Ski Resort, located in the privileged environment of the Catalan Pyrenees, is an authentic reference among the winter destinations in Spain. With its multiple slopes and stunning scenery, it offers one of the best skiing experiences in the country. <a href="javascript:void(0)" style="color:var(--color-primary);">Read more</a></div>
    </div>

    <!-- Getting There -->
    <div class="section-header">
      <svg viewBox="0 0 384 512" fill="currentColor"><path d="M352 192c0-88.4-71.6-160-160-160S32 103.6 32 192c0 15.6 5.4 37 16.6 63.4c10.9 25.9 26.2 54 43.6 82.1c34.1 55.3 74.4 108.2 99.9 140c25.4-31.8 65.8-84.7 99.9-140c17.3-28.1 32.7-56.3 43.6-82.1C346.6 229 352 207.6 352 192zm32 0c0 87.4-117 243-168.3 307.2c-12.3 15.3-35.1 15.3-47.4 0C117 435 0 279.4 0 192C0 86 86 0 192 0S384 86 384 192zm-240 0a48 48 0 1 0 96 0 48 48 0 1 0 -96 0zm48 80a80 80 0 1 1 0-160 80 80 0 1 1 0 160z"/></svg>
      <h2>Getting there</h2>
    </div>
    <div class="location">
      <div class="loc-name">Baqueira Beret - Sector Bonaigua</div>
      <div class="loc-address">Baqueira Beret Parking Lot, 25598</div>
      <div class="map-placeholder">
        <img src="img/map-baqueira.png" alt="Map area Baqueira – Estación de Esquí Baqueira Beret">
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      <div class="footer-cols">
        <div class="footer-col"><h5>About Fever</h5><ul><li><a href="press.html">Press</a></li><li><a href="careers.html">Careers</a></li><li><a href="gift-cards.html">Gift Cards</a></li><li><a href="help-center.html">Help Center</a></li></ul></div>
        <div class="footer-col"><h5>Partner with us</h5><ul><li><a href="fever-zone.html">Fever Zone</a></li><li><a href="list-event.html">List your event</a></li><li><a href="affiliate.html">Affiliate Program</a></li></ul></div>
      </div>
      <div class="legal"><a href="terms.html">Terms of Use</a> | <a href="privacy.html">Privacy Policy</a> | <a href="cookies.html">Cookie Policy</a><div style="margin-top:8px;text-align:right;">&copy;2026 &ndash; Fever</div></div>
    </div>

    <div class="sticky-cta">
      <button class="cta-btn" id="sticky-btn">Select transport</button>
    </div>

    <!-- Cross-sell bottom sheet (Option H): offer accommodation after transportation -->
    <div class="crosssell-overlay" id="crosssell-overlay"></div>
    <div class="crosssell-sheet" id="crosssell-sheet">
      <div class="handle"></div>
      <h3>Anything else?</h3>
      <div class="hub-actions">
        <button type="button" class="hub-btn secondary" id="crosssell-yes"><svg viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><path d="M9 22V12h6v10"/></svg> Add hotel</button>
        <button type="button" class="hub-btn primary" id="crosssell-no">Skip hotel</button>
      </div>
    </div>
  </div>

  <!-- Fullscreen Gallery Overlay -->
  <div class="fs-gallery" id="fsGallery">
    <div class="fs-gallery-topbar">
      <button type="button" class="fs-gallery-close" id="fsGalleryClose" aria-label="Close gallery"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
    </div>
    <div class="fs-gallery-viewport" id="fsGalleryViewport">
      <div class="fs-gallery-track" id="fsGalleryTrack"></div>
      <button type="button" class="fs-gallery-arrow prev" id="fsGalleryPrev" aria-label="Previous"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg></button>
      <button type="button" class="fs-gallery-arrow next" id="fsGalleryNext" aria-label="Next"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 6 15 12 9 18"/></svg></button>
    </div>
    <div class="fs-gallery-thumbs" id="fsGalleryThumbs"></div>
  </div>

  <script src="js/burger-menu.js"></script>
  <script>
    const params = new URLSearchParams(window.location.search);
    let flow = params.get('flow');
    let storedFlow = null;
    try { storedFlow = sessionStorage.getItem('polar_flow_mode'); } catch (e) {}
    if (!flow && (storedFlow === 'c1' || storedFlow === 'c2' || storedFlow === 'd1' || storedFlow === 'd2' || storedFlow === 'e1' || storedFlow === 'e2')) flow = storedFlow;
    const isOptionB = flow === 'a2';
    const isOptionE = flow === 'c1';
    const isOptionF = flow === 'c2' || flow === 'd1';
    const isOptionG = flow === 'd2';
    const isOptionH = flow === 'e1';
    const isOptionI = flow === 'e2';
    const isSequentialFlow = (flow === 'c1' || flow === 'c2');
    const isHubFlow = (!isSequentialFlow) && (isOptionF || isOptionG || isOptionH || isOptionI);
    const isCrossSellFlow = isOptionH || isOptionI;
    const isOptionalFlow = isSequentialFlow || isHubFlow;
    if (isOptionalFlow) {
      try { sessionStorage.setItem('polar_flow_mode', flow); } catch (e) {}
    }
    if (isSequentialFlow) {
      document.getElementById('flow-stepper').classList.add('stepper-hidden');
      var generalInfoBlock = document.getElementById('general-info-block');
      if (generalInfoBlock) generalInfoBlock.style.display = 'none';
    } else if (isHubFlow) {
      if (!isCrossSellFlow) {
        document.getElementById('flow-stepper').classList.add('stepper-hidden');
      }
      var generalInfoBlock = document.getElementById('general-info-block');
      if (generalInfoBlock) generalInfoBlock.style.display = 'none';
    }

    // e1/e2: hide stepper (no progress indicator for these flows)
    if (isCrossSellFlow) {
      var stepperEl = document.getElementById('flow-stepper');
      if (stepperEl) stepperEl.classList.add('stepper-hidden');
    }
    if (isOptionB) {
      document.getElementById('nav-logo').href = 'a2/index.html';
    } else if (isHubFlow) {
      document.getElementById('nav-logo').href = flow + '/';
    } else {
      document.getElementById('nav-logo').href = 'home.html';
    }

    const TRANSPORT_OPTIONS = [
      { name: 'Bus Barcelona – Baqueira (round trip)', detail: 'Departure Fri 12 Mar, return Sun 14 Mar', price: 49.00 },
      { name: 'Shuttle Madrid – Baqueira (round trip)', detail: 'Departure Fri 12 Mar, return Sun 14 Mar', price: 69.00 },
      { name: 'Shuttle Vielha – Baqueira (round trip)', detail: 'Local shuttle, multiple times', price: 19.00 }
    ];

    const transportRowsEl = document.getElementById('transport-rows');
    const stickyBtn = document.getElementById('sticky-btn');
    const transportSection = document.getElementById('transport-section');
    let counts = TRANSPORT_OPTIONS.map(() => 0);
    let stickyMode = 'select';
    let hasSeenTransport = false;

    if (isOptionB) {
      document.getElementById('step1').href = 'a2/polar-sound.html#ticket-section';
      document.getElementById('step2').href = 'a2/polar-sound-accommodation.html#ticket-section';
      document.getElementById('step4').href = 'a2/cart.html';
      document.getElementById('step4-label').textContent = 'Cart';
    } else if (isHubFlow) {
      document.getElementById('step1').href = 'polar-sound.html?flow=' + flow + '#ticket-section';
      document.getElementById('step2').href = 'polar-sound-accommodation.html?flow=' + flow + '#ticket-section';
      if (isOptionG || isOptionI) {
        document.getElementById('step4').href = 'cart.html?flow=' + flow;
        document.getElementById('step4-label').textContent = 'Cart';
      } else {
        document.getElementById('step4').href = 'checkout.html?flow=' + flow;
        document.getElementById('step4-label').textContent = 'Checkout';
      }
      // Don't clear accommodation for d2 (cart flow) or if user came from accommodation cross-sell
      if (isCrossSellFlow) {
        var initCameFrom = '';
        try { initCameFrom = sessionStorage.getItem('option_h_came_from') || ''; } catch(e) {}
        if (initCameFrom !== 'accommodation') {
          try { localStorage.setItem('cart_accommodation', '[]'); } catch (e) {}
        }
      } else if (!isOptionG) {
        try { localStorage.setItem('cart_accommodation', '[]'); } catch (e) {}
      }
    } else {
      document.getElementById('step1').href = 'polar-sound.html#ticket-section';
      document.getElementById('step2').href = 'polar-sound-accommodation.html#ticket-section';
      document.getElementById('step4').href = 'checkout.html';
      document.getElementById('step4-label').textContent = 'Checkout';
    }

    function hasAnyCartItems() {
      var tickets = [], accommodation = [], transportation = [];
      try {
        tickets = JSON.parse(localStorage.getItem('cart_tickets') || '[]');
        accommodation = JSON.parse(localStorage.getItem('cart_accommodation') || '[]');
        transportation = JSON.parse(localStorage.getItem('cart_transportation') || '[]');
      } catch (e) {}
      function hasItems(arr) {
        return Array.isArray(arr) && arr.some(function(item) { return item && (item.qty || 0) > 0; });
      }
      return hasItems(tickets) || hasItems(accommodation) || hasItems(transportation);
    }

    function setCartStepClickable() {
      var step4 = document.getElementById('step4');
      if (!step4) return;
      var enabledHref = step4.getAttribute('data-enabled-href') || step4.getAttribute('href') || '';
      step4.setAttribute('data-enabled-href', enabledHref);
      if (isOptionB && !hasAnyCartItems()) {
        step4.removeAttribute('href');
        step4.classList.add('disabled');
        step4.setAttribute('aria-disabled', 'true');
        step4.setAttribute('tabindex', '-1');
      } else {
        if (enabledHref) step4.setAttribute('href', enabledHref);
        step4.classList.remove('disabled');
        step4.removeAttribute('aria-disabled');
        step4.removeAttribute('tabindex');
      }
    }
    setCartStepClickable();

    (function() {
      var tickets = [], accommodation = [];
      try { tickets = JSON.parse(localStorage.getItem('cart_tickets') || '[]'); accommodation = JSON.parse(localStorage.getItem('cart_accommodation') || '[]'); } catch (e) {}
      var hasTickets = tickets.length > 0 && tickets.some(function(t) { return (t.qty || 0) > 0; });
      var hasAccommodation = accommodation.length > 0 && accommodation.some(function(a) { return (a.qty || 0) > 0; });
      if (!hasTickets) document.getElementById('step1').classList.add('skipped');
      if (!hasAccommodation) document.getElementById('step2').classList.add('skipped');
    })();

    function render() {
      transportRowsEl.innerHTML = '';
      TRANSPORT_OPTIONS.forEach((opt, i) => {
        const row = document.createElement('div');
        row.className = 'ticket-row' + (counts[i] > 0 ? ' selected' : '') + (counts[i] === 0 ? ' qty-zero' : '');
        row.innerHTML =
          '<div class="ticket-content">' +
            '<div class="ticket-name">' + opt.name + '</div>' +
            (opt.detail ? '<button type="button" class="ticket-info-toggle" aria-expanded="false">More info</button><div class="ticket-info-detail">' + opt.detail + '</div>' : '') +
            '<div class="ticket-price">€' + opt.price.toFixed(2) + ' <span style="font-weight:400;color:#536b75;">per person</span></div>' +
          '</div>' +
          '<div class="ticket-notch"><span class="notch-line"></span></div>' +
          '<div class="ticket-selector-right">' +
            '<div class="ticket-amount stepper">' +
              '<button type="button" class="amt-btn minus" data-i="' + i + '" data-delta="-1">&minus;</button>' +
              '<span class="amt-count">' + counts[i] + '</span>' +
              '<button type="button" class="amt-btn plus" data-i="' + i + '" data-delta="1">+</button>' +
            '</div>' +
          '</div>';
        transportRowsEl.appendChild(row);

        row.querySelectorAll('.amt-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const i = parseInt(this.dataset.i, 10);
            const delta = parseInt(this.dataset.delta, 10);
            const max = opt.price === 0 ? 1 : 20;
            counts[i] = Math.max(0, Math.min(max, counts[i] + delta));
            if (opt.price === 0 && counts[i] > 0) {
              counts = counts.map((_, j) => j === i ? 1 : 0);
            }
            saveTransportSelection();
            render();
            updateSticky();
          });
        });
        row.querySelectorAll('.ticket-info-toggle').forEach(btn => {
          btn.addEventListener('click', function() {
            const r = this.closest('.ticket-row');
            const expanded = r.classList.toggle('ticket-info-expanded');
            this.setAttribute('aria-expanded', expanded);
            this.textContent = expanded ? 'Less info' : 'More info';
          });
        });
      });
      updateSticky();
    }

    function getTotal() {
      let t = 0;
      TRANSPORT_OPTIONS.forEach((opt, i) => { t += opt.price * (counts[i] || 0); });
      return t;
    }

    function updateSticky() {
      if (stickyMode === 'select') {
        stickyBtn.textContent = 'Select transport';
        return;
      }
      const total = getTotal();
      if (total > 0) {
        stickyBtn.textContent = '€' + total.toFixed(2) + ' — Add it';
      } else {
        stickyBtn.textContent = 'Skip transport';
      }
    }

    const transportObs = new IntersectionObserver((entries) => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          hasSeenTransport = true;
          stickyMode = 'continue';
          updateSticky();
        } else if (!hasSeenTransport) {
          stickyMode = 'select';
          stickyBtn.textContent = 'Select transport';
        } else {
          stickyMode = 'continue';
          updateSticky();
        }
      });
    }, { threshold: 0.1 });
    transportObs.observe(transportSection);

    function buildTransportCart() {
      var cart = [];
      TRANSPORT_OPTIONS.forEach(function(opt, i) {
        var qty = counts[i] || 0;
        if (qty > 0) cart.push({ name: opt.name, detail: opt.detail || '', price: opt.price, qty: qty });
      });
      return cart;
    }

    function saveTransportToCart() {
      localStorage.setItem('cart_transportation', JSON.stringify(buildTransportCart()));
    }

    function saveTransportSelection() {
      localStorage.setItem('polar_sel_transportation', JSON.stringify(buildTransportCart()));
    }

    function saveAndRedirect() {
      saveTransportToCart();

      // Sequential c1/c2: preserve hotel selection; c2 goes to cart, c1 to checkout
      if (isSequentialFlow) {
        var dest = (flow === 'c2') ? 'cart.html?flow=' + flow : 'checkout.html?flow=' + flow;
        window.location.href = dest;
        return;
      }

      // Option H/I: show cross-sell bottom sheet if user came from hub (not from accommodation)
      if (isCrossSellFlow) {
        var cameFrom = '';
        try { cameFrom = sessionStorage.getItem('option_h_came_from') || ''; } catch(e) {}
        if (cameFrom !== 'accommodation') {
          openCrossSellSheet();
          return;
        }
      }

      if (isOptionB) {
        window.location.href = (window.flowHref||function(u){return u})('a2/cart.html');
      } else if (isCrossSellFlow) {
        var cameFromForClear = '';
        try { cameFromForClear = sessionStorage.getItem('option_h_came_from') || ''; } catch(e) {}
        if (cameFromForClear !== 'accommodation') {
          try { localStorage.setItem('cart_accommodation', '[]'); } catch (e) {}
        }
        var dest = isOptionI ? 'cart.html?flow=e2' : 'checkout.html?flow=e1';
        window.location.href = dest;
      } else if (isOptionG) {
        window.location.href = 'cart.html?flow=d2';
      } else if (isOptionF) {
        try { localStorage.setItem('cart_accommodation', '[]'); } catch (e) {}
        window.location.href = 'checkout.html?flow=' + flow;
      } else if (flow) {
        window.location.href = 'checkout.html?flow=' + flow;
      } else {
        window.location.href = (window.flowHref||function(u){return u})('checkout.html');
      }
    }

    function scrollToTransport(behavior) {
      var header = document.querySelector('.sticky-header');
      var offset = header ? header.offsetHeight : 0;
      var y = transportSection.getBoundingClientRect().top + window.pageYOffset - offset;
      window.scrollTo({ top: Math.max(0, y), behavior: behavior || 'auto' });
    }

    stickyBtn.addEventListener('click', () => {
      if (stickyMode === 'select') {
        scrollToTransport('smooth');
      } else {
        saveAndRedirect();
      }
    });

    var isDefaultFlow = !flow || flow === 'a1' || flow === 'a2';

    // Check nav token: if absent (refresh / direct entry), clear step selections
    (function() {
      if (isDefaultFlow) {
        var token = null;
        try { token = sessionStorage.getItem('polar_step_nav'); } catch(e) {}
        if (token) {
          try { sessionStorage.removeItem('polar_step_nav'); } catch(e) {}
        } else {
          try { localStorage.removeItem('cart_accommodation'); } catch(e) {}
          try { localStorage.removeItem('cart_transportation'); } catch(e) {}
          try { localStorage.removeItem('polar_sel_accommodation'); } catch(e) {}
          try { localStorage.removeItem('polar_sel_transportation'); } catch(e) {}
        }
      }
    })();

    // Set nav token before any stepper link click
    document.querySelectorAll('.flow-stepper a.step').forEach(function(link) {
      link.addEventListener('click', function() {
        try { sessionStorage.setItem('polar_step_nav', '1'); } catch(e) {}
      });
    });

    // c1/c2 sequential: clear any previous selections so page starts fresh
    if (flow === 'c1' || flow === 'c2') {
      try { localStorage.removeItem('polar_sel_transportation'); } catch(e) {}
      try { localStorage.removeItem('cart_transportation'); } catch(e) {}
    }

    // Restore transport selections (visual persistence across step navigation)
    (function restoreTransportSelection() {
      try {
        var saved = JSON.parse(localStorage.getItem('polar_sel_transportation') || '[]');
        if (!Array.isArray(saved) || saved.length === 0) {
          saved = JSON.parse(localStorage.getItem('cart_transportation') || '[]');
        }
        if (!Array.isArray(saved) || saved.length === 0) return;
        saved.forEach(function(item) {
          TRANSPORT_OPTIONS.forEach(function(opt, i) {
            if (opt.name === item.name && item.qty > 0) counts[i] = item.qty;
          });
        });
        if (counts.some(function(c) { return c > 0; })) {
          hasSeenTransport = true;
          stickyMode = 'continue';
        }
      } catch (e) {}
    })();

    // For a1/a2/default flow, always enable the "Skip transport" / "Add it" CTA
    if (isDefaultFlow) {
      hasSeenTransport = true;
      stickyMode = 'continue';
    }

    // c1/c2/d1/d2: show "Skip transport" CTA immediately (no pre-selection)
    if (flow === 'c1' || flow === 'c2' || flow === 'd1' || flow === 'd2') {
      hasSeenTransport = true;
      stickyMode = 'continue';
    }

    // Hub flows (except d1/d2): pre-select first transport option when no prior selection exists
    if (isHubFlow && flow !== 'd1' && flow !== 'd2' && !counts.some(function(c) { return c > 0; })) {
      var firstPaid = TRANSPORT_OPTIONS.findIndex(function(opt) { return opt.price > 0; });
      if (firstPaid >= 0) {
        counts[firstPaid] = 1;
        hasSeenTransport = true;
        stickyMode = 'continue';
      }
    }

    render();
    // Scroll to transport selector on load without animation (no visible autoscroll from hero).
    document.documentElement.style.scrollBehavior = 'auto';
    setTimeout(function() {
      scrollToTransport('auto');
      document.documentElement.style.scrollBehavior = '';
    }, 50);

    // === Cross-sell bottom sheet (Option H) ===
    function openCrossSellSheet() {
      var overlay = document.getElementById('crosssell-overlay');
      var sheet = document.getElementById('crosssell-sheet');
      if (overlay) overlay.classList.add('open');
      if (sheet) sheet.classList.add('open');
      document.body.style.overflow = 'hidden';
    }
    function closeCrossSellSheet() {
      var overlay = document.getElementById('crosssell-overlay');
      var sheet = document.getElementById('crosssell-sheet');
      if (sheet) sheet.style.transform = '';
      if (overlay) overlay.classList.remove('open');
      if (sheet) sheet.classList.remove('open');
      document.body.style.overflow = '';
    }
    (function bindCrossSell() {
      var overlay = document.getElementById('crosssell-overlay');
      var btnYes = document.getElementById('crosssell-yes');
      var btnNo = document.getElementById('crosssell-no');
      if (overlay) overlay.addEventListener('click', closeCrossSellSheet);
      if (btnYes) {
        btnYes.addEventListener('click', function() {
          try { sessionStorage.setItem('option_h_came_from', 'transportation'); } catch(e) {}
          window.location.href = 'polar-sound-accommodation.html?flow=' + flow;
        });
      }
      if (btnNo) {
        btnNo.addEventListener('click', function() {
          try { localStorage.setItem('cart_accommodation', '[]'); } catch(e) {}
          var noDest = isOptionI ? 'cart.html?flow=e2' : 'checkout.html?flow=e1';
          window.location.href = noDest;
        });
      }
    })();
    // Swipe-to-dismiss for cross-sell sheet
    (function() {
      var sheetEl = document.getElementById('crosssell-sheet');
      if (!sheetEl) return;
      var startY = 0, currentY = 0, isDragging = false;
      function dragStart(y) { startY = y; currentY = y; isDragging = true; sheetEl.style.transition = 'none'; }
      function dragMove(y, e) { if (!isDragging) return; currentY = y; var dy = currentY - startY; if (dy < 0) dy = 0; if (dy > 0) { if (e) e.preventDefault(); sheetEl.style.transform = 'translateX(-50%) translateY(' + dy + 'px)'; } }
      function dragEnd() { if (!isDragging) return; isDragging = false; sheetEl.style.transition = ''; sheetEl.style.transform = ''; if (currentY - startY > 80) closeCrossSellSheet(); }
      sheetEl.addEventListener('touchstart', function(e) { dragStart(e.touches[0].clientY); }, { passive: true });
      sheetEl.addEventListener('touchmove', function(e) { dragMove(e.touches[0].clientY, e); }, { passive: false });
      sheetEl.addEventListener('touchend', dragEnd);
      sheetEl.addEventListener('mousedown', function(e) { e.preventDefault(); dragStart(e.clientY); });
      document.addEventListener('mousemove', function(e) { if (isDragging) dragMove(e.clientY, e); });
      document.addEventListener('mouseup', dragEnd);
    })();
  </script>
  <script>
    (function(){
      var FAVORITES_KEY='polar_liked_plans';
      var likeBtn=document.querySelector('.side-btn[aria-label="Like"]');
      if(!likeBtn)return;
      function readFav(){try{var r=localStorage.getItem(FAVORITES_KEY);var p=r?JSON.parse(r):{};return p&&typeof p==='object'?p:{};}catch(e){return {};}}
      function writeFav(f){try{localStorage.setItem(FAVORITES_KEY,JSON.stringify(f));}catch(e){}}
      var titleNode=document.querySelector('.title-section h1');
      var heroImg=document.querySelector('.carousel-slide img')||document.querySelector('.hero-bg')||document.querySelector('.hero img');
      var planTitle=titleNode?titleNode.textContent.trim():document.title;
      var planImage=heroImg?heroImg.src:'';
      var planHref=window.location.href.split('?')[0].split('#')[0];
      var slug='polar-sound';
      var planId='plan-view::'+slug;
      var fav=readFav();
      if(fav[planId]){likeBtn.classList.add('liked');likeBtn.setAttribute('aria-label','Remove from favorites');}
      likeBtn.addEventListener('click',function(e){
        e.preventDefault();e.stopPropagation();
        var isLiked=likeBtn.classList.toggle('liked');
        fav=readFav();
        if(isLiked){
          fav[planId]={id:planId,title:planTitle,meta:'',price:'',badge:'',href:planHref,image:planImage};
          likeBtn.setAttribute('aria-label','Remove from favorites');
        }else{
          delete fav[planId];
          likeBtn.setAttribute('aria-label','Like');
        }
        writeFav(fav);
      });
    })();
  </script>
  <script>
  (function() {
    var fsGallery = document.getElementById('fsGallery');
    var fsTrack = document.getElementById('fsGalleryTrack');
    var fsThumbs = document.getElementById('fsGalleryThumbs');
    var fsClose = document.getElementById('fsGalleryClose');
    var fsViewport = document.getElementById('fsGalleryViewport');
    var fsPrev = document.getElementById('fsGalleryPrev');
    var fsNext = document.getElementById('fsGalleryNext');
    var galleryBtn = document.querySelector('.gallery-btn');
    if (!fsGallery || !galleryBtn) return;

    var images = [];
    var fsCurrent = 0;
    var fsTouchStartX = 0, fsTouchStartY = 0, fsSwiping = false;

    function collectImages() {
      images = [];
      var carouselImgs = document.querySelectorAll('.carousel-slide img');
      if (carouselImgs.length) {
        carouselImgs.forEach(function(img) {
          if (img.src && !img.closest('.carousel-slide').classList.contains('clone-slide')) images.push(img.src);
        });
      } else {
        var heroImg = document.querySelector('.hero-bg') || document.querySelector('#hero-img') || document.querySelector('.hero img');
        if (heroImg && heroImg.src) images.push(heroImg.src);
      }
    }

    function buildSlides() {
      fsTrack.innerHTML = '';
      fsThumbs.innerHTML = '';
      images.forEach(function(src, i) {
        var slide = document.createElement('div');
        slide.className = 'fs-gallery-slide';
        var img = document.createElement('img');
        img.src = src; img.alt = 'Photo ' + (i + 1); img.draggable = false;
        slide.appendChild(img);
        fsTrack.appendChild(slide);
        var thumb = document.createElement('div');
        thumb.className = 'fs-gallery-thumb' + (i === 0 ? ' active' : '');
        var tImg = document.createElement('img');
        tImg.src = src; tImg.alt = 'Thumbnail ' + (i + 1);
        thumb.appendChild(tImg);
        thumb.addEventListener('click', (function(idx) { return function() { fsGoTo(idx); }; })(i));
        fsThumbs.appendChild(thumb);
      });
    }

    function scrollThumbIntoView(idx) {
      var th = fsThumbs.children[idx];
      if (!th) return;
      fsThumbs.scrollTo({ left: th.offsetLeft - fsThumbs.offsetWidth / 2 + th.offsetWidth / 2, behavior: 'smooth' });
    }

    function updateArrows() {
      fsPrev.style.display = fsCurrent <= 0 ? 'none' : '';
      fsNext.style.display = fsCurrent >= images.length - 1 ? 'none' : '';
    }

    function fsGoTo(idx) {
      if (idx < 0) idx = 0;
      if (idx >= images.length) idx = images.length - 1;
      fsCurrent = idx;
      fsTrack.style.transform = 'translateX(-' + (idx * 100) + '%)';
      fsThumbs.querySelectorAll('.fs-gallery-thumb').forEach(function(t, i) { t.classList.toggle('active', i === idx); });
      scrollThumbIntoView(idx);
      updateArrows();
    }

    function openGallery() {
      collectImages();
      if (!images.length) return;
      buildSlides();
      fsGoTo(0);
      fsGallery.classList.add('open');
      document.body.style.overflow = 'hidden';
    }

    function closeGallery() {
      fsGallery.classList.remove('open');
      document.body.style.overflow = '';
    }

    galleryBtn.addEventListener('click', function(e) { e.preventDefault(); openGallery(); });
    fsClose.addEventListener('click', closeGallery);
    fsPrev.addEventListener('click', function() { fsGoTo(fsCurrent - 1); });
    fsNext.addEventListener('click', function() { fsGoTo(fsCurrent + 1); });
    fsGallery.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') closeGallery();
      if (e.key === 'ArrowRight') fsGoTo(fsCurrent + 1);
      if (e.key === 'ArrowLeft') fsGoTo(fsCurrent - 1);
    });
    fsViewport.addEventListener('touchstart', function(e) { fsTouchStartX = e.touches[0].clientX; fsTouchStartY = e.touches[0].clientY; fsSwiping = false; fsTrack.classList.add('no-transition'); }, { passive: true });
    fsViewport.addEventListener('touchmove', function(e) {
      var dx = e.touches[0].clientX - fsTouchStartX;
      var dy = e.touches[0].clientY - fsTouchStartY;
      if (!fsSwiping && Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > 8) fsSwiping = true;
      if (fsSwiping) { e.preventDefault(); fsTrack.style.transform = 'translateX(' + (-(fsCurrent * 100) + (dx / fsViewport.offsetWidth) * 100) + '%)'; }
    }, { passive: false });
    fsViewport.addEventListener('touchend', function(e) {
      fsTrack.classList.remove('no-transition');
      if (!fsSwiping) return;
      var dx = e.changedTouches[0].clientX - fsTouchStartX;
      if (Math.abs(dx) > 50) { dx > 0 ? fsGoTo(fsCurrent - 1) : fsGoTo(fsCurrent + 1); } else { fsGoTo(fsCurrent); }
    });
  })();
  </script>
<script>if(localStorage.getItem('fever_logged_in')==='true'){document.documentElement.classList.add('u-in');var a=document.querySelector('.avatar-wrap');if(a){a.href='profile.html';}}</script>
  <script src="js/recently-viewed.js"></script>
  <script src="js/flow-param.js"></script>
</body>
</html>
