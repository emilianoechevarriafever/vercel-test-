<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/png" sizes="32x32" href="../../../favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../../favicons/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="../../../favicons/apple-touch-icon.png">
  <link rel="shortcut icon" href="../../../favicon.ico">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Occident - Cart - Polar Sound 2026</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
    :root {
      --color-primary: #0079ca;
      --color-text: #031419;
      --color-text-subtle: #536b75;
      --color-border: #ccd2d8;
      --color-bg: #ffffff;
      --color-bg-neutral: #f2f3f3;
      --font: 'Montserrat', sans-serif;
    }
    html { scroll-behavior: smooth; -webkit-tap-highlight-color: transparent; }
    body { font-family:var(--font); background:var(--color-bg-neutral); display:flex; justify-content:center; color:var(--color-text); overflow-x:hidden; }
    .phone { width:393px; max-width:100vw; background:var(--color-bg); min-height:100vh; position:relative; padding-bottom:100px; }

    .sticky-header { position:sticky; top:0; z-index:100; background:#fff; }
    .navbar { display:flex; align-items:center; justify-content:space-between; padding:10px 16px; background:#fff; border-top:none; border-bottom:1px solid #ccd2d8; }
    .navbar .logo-link { text-decoration:none; display:flex; align-items:center; }
    .navbar .logo-link img { height:38px; width:auto; display:block; object-fit:contain; }
    .nav-icons { display:flex; align-items:center; gap:20px; }
    .nav-icons svg { height:24px; width:auto; color:var(--color-text); cursor:pointer; }
    .nav-icon-btn{all:unset;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;color:inherit;width:24px;height:24px;flex-shrink:0;box-sizing:border-box;overflow:visible}
    .nav-icon-btn svg { height:24px; width:auto; color:var(--color-text); }
    .avatar-wrap{all:unset;position:relative;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;width:24px;height:24px;flex-shrink:0;box-sizing:border-box}
    .avatar-wrap img { width:24px; height:24px; border-radius:50%; object-fit:cover; display:none;}
    .avatar-wrap .avatar-placeholder { display:flex;}
    html.u-in .avatar-wrap::after { content:''; position:absolute; top:-1px; right:-1px; width:8px; height:8px; background:#22ad5c; border:1.5px solid white; border-radius:50%; }
    html.u-in .avatar-wrap img{display:block}
    html.u-in .avatar-wrap .avatar-placeholder{display:none}
    .event-summary { display:flex; gap:12px; padding:16px; align-items:center; border-bottom:1px solid var(--color-border); }
    .event-summary .event-thumb { width:56px; height:56px; border-radius:8px; overflow:hidden; flex-shrink:0; }
    .event-summary .event-thumb img { width:100%; height:100%; object-fit:cover; }
    .event-summary .event-info { flex:1; }
    .event-summary .event-name { font-size:14px; font-weight:600; line-height:20px; margin-bottom:2px; }
    .event-summary .event-venue { font-size:12px; color:var(--color-text-subtle); display:flex; align-items:center; gap:4px; }
    .event-summary .event-venue svg { width:12px; height:12px; flex-shrink:0; }

    .cart-section { padding:12px 16px; border-bottom:1px solid var(--color-border); }
    .section-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:4px; }
    .section-header h3 { font-size:16px; font-weight: 600; margin:0; }
    .section-header .empty-state-link { margin:0; }

    .swipe-container { position:relative; overflow:hidden; border-bottom:1px solid var(--color-border); }
    .swipe-container:last-child { border-bottom:none; }
    .swipe-delete { position:absolute; top:0; right:0; bottom:0; width:80px; background:#eb0052; display:none; align-items:center; justify-content:center; color:#fff; }
    .swipe-container.active-swipe .swipe-delete { display:flex; }
    .swipe-delete svg { width:22px; height:22px; stroke:#fff; fill:none; stroke-width:1.8; stroke-linecap:round; stroke-linejoin:round; }
    .swipe-inner { position:relative; background:#fff; z-index:1; transition:transform 0.2s ease; }
    .swipe-inner.swiping { transition:none; }

    .cart-item { display:flex; align-items:flex-start; justify-content:space-between; gap:12px; padding:10px 0; }
    .cart-item .item-left { flex:1; min-width:0; }
    .cart-item .item-name { font-size:14px; font-weight:500; margin-bottom:2px; }
    .cart-item .item-detail { font-size:12px; color:var(--color-text-subtle); margin-bottom:4px; }
    .cart-item .item-price { font-size:14px; font-weight:600; margin-top:4px; }
    .cart-item .qty-wrap { display:flex; align-items:center; gap:4px; }
    .cart-item .qty-wrap button { width:32px; height:32px; border:none; border-radius:50%; font-size:18px; cursor:pointer; line-height:1; display:inline-flex; align-items:center; justify-content:center; flex-shrink:0; transition:background 0.15s, color 0.15s; }
    .cart-item .qty-wrap button svg { width:16px; height:16px; stroke:currentColor; fill:none; display:block; }
    .cart-item .qty-wrap button:first-child { background:#f2f3f3; color:#a7b2ba; }
    .cart-item .qty-wrap button:last-child { background:#e6f4ff; color:#0079ca; }
    .cart-item .qty-wrap input { width:36px; border:none; text-align:center; font-size:16px; font-weight:600; padding:0; background:transparent; color:#031419; -moz-appearance:textfield; }
    .cart-item .qty-wrap input::-webkit-outer-spin-button,
    .cart-item .qty-wrap input::-webkit-inner-spin-button { -webkit-appearance:none; margin:0; }

    .cart-total { padding:16px; font-size:16px; font-weight: 600; display:flex; justify-content:space-between; }
    .empty-state-row { display:none; }
    .empty-state-link {
      display:inline-flex;
      align-items:center;
      justify-content:center;
      text-decoration:none;
      white-space:nowrap;
      border:1px solid #BFD9EF;
      color:var(--color-primary);
      background:#F3FAFF;
      border-radius:64px;
      padding:6px 14px;
      font-size:14px;
      font-weight:600;
      line-height:16px;
    }
    .sticky-cta { position:fixed; bottom:0; width:393px; max-width:100vw; z-index:200; background:transparent; padding:12px 16px max(12px, env(safe-area-inset-bottom)); }
    .sticky-cta .cta-btn { display:block; width:100%; height:48px; background:#0079ca; border:2px solid transparent; border-radius:64px; color:#fff; font-family:var(--font); font-weight:600; font-size:16px; line-height:24px; cursor:pointer; transition:background 0.2s, border-color 0.2s, box-shadow 0.2s, color 0.2s, opacity 0.2s; outline:none; }
    .sticky-cta .cta-btn:hover { background:#0079ca; }
    .sticky-cta .cta-btn:focus-visible { border-color:#005795; box-shadow:0 0 0 4px rgba(0,121,202,0.32); }
    .sticky-cta .cta-btn:active { background:#0079ca; }
    .sticky-cta .cta-btn:disabled, .sticky-cta .cta-btn.disabled { background:#f2f3f3; color:#a7b2ba; border-color:transparent; box-shadow:none; cursor:default; opacity:1; }
    /* Focus-visible */
    button:focus-visible, a:focus-visible { outline: 2px solid #0079ca; outline-offset: 2px; }
    /* Tap feedback */
    .nav-icon-btn:active { opacity:0.6; }
    .ticket-pill:active { transform:scale(0.96); }
  </style>
  <link rel="stylesheet" href="../../../css/navbar.css">
<script>if(localStorage.getItem("fever_logged_in")==="true")document.documentElement.classList.add("u-in")</script>
</head>
<body>
  <div class="phone">
    <header class="sticky-header">
    <nav class="navbar">
      <a href="index.html" class="logo-link"><img src="../img/fever-logo.svg" alt="Fever"></a>
      <div class="nav-icons">
        <a class="nav-icon-btn" href="../../../search.html" aria-label="Search"><svg viewBox="0 0 512 512" fill="currentColor"><path d="M384 208A176 176 0 1 0 32 208a176 176 0 1 0 352 0zM343.3 366C307 397.2 259.7 416 208 416C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208c0 51.7-18.8 99-50 135.3L507.3 484.7c6.2 6.2 6.2 16.4 0 22.6s-16.4 6.2-22.6 0L343.3 366z"/></svg></a>
        <a class="nav-icon-btn" href="index.html" aria-label="Location"><svg viewBox="0 0 384 512" fill="currentColor"><path d="M352 192c0-88.4-71.6-160-160-160S32 103.6 32 192c0 15.6 5.4 37 16.6 63.4c10.9 25.9 26.2 54 43.6 82.1c34.1 55.3 74.4 108.2 99.9 140c25.4-31.8 65.8-84.7 99.9-140c17.3-28.1 32.7-56.3 43.6-82.1C346.6 229 352 207.6 352 192zm32 0c0 87.4-117 243-168.3 307.2c-12.3 15.3-35.1 15.3-47.4 0C117 435 0 279.4 0 192C0 86 86 0 192 0S384 86 384 192zm-240 0a48 48 0 1 0 96 0 48 48 0 1 0 -96 0zm48 80a80 80 0 1 1 0-160 80 80 0 1 1 0 160z"/></svg></a>
        <a class="nav-icon-btn" href="../favorites.html" aria-label="Favorites"><svg viewBox="0 0 512 512" fill="currentColor"><path d="M244 130.6l-12-13.5-4.2-4.7c-26-29.2-65.3-42.8-103.8-35.8c-53.3 9.7-92 56.1-92 110.3v3.5c0 32.3 13.4 63.1 37.1 85.1L253 446.8c.8 .7 1.9 1.2 3 1.2s2.2-.4 3-1.2L443 275.5c23.6-22 37-52.8 37-85.1v-3.5c0-54.2-38.7-100.6-92-110.3c-38.5-7-77.8 6.6-103.8 35.8l-4.2 4.7-12 13.5c-3 3.4-7.4 5.4-12 5.4s-8.9-2-12-5.4zm34.9-57.1C311 48.4 352.7 37.7 393.7 45.1C462.2 57.6 512 117.3 512 186.9v3.5c0 36-13.1 70.6-36.6 97.5c-3.4 3.8-6.9 7.5-10.7 11l-184 171.3c-.8 .8-1.7 1.5-2.6 2.2c-6.3 4.9-14.1 7.5-22.1 7.5c-9.2 0-18-3.5-24.8-9.7L47.2 299c-3.8-3.5-7.3-7.2-10.7-11C13.1 261 0 226.4 0 190.4v-3.5C0 117.3 49.8 57.6 118.3 45.1c40.9-7.4 82.6 3.2 114.7 28.4c6.7 5.3 13 11.1 18.7 17.6l4.2 4.7 4.2-4.7c4.2-4.7 8.6-9.1 13.3-13.1c1.8-1.5 3.6-3 5.4-4.5z"/></svg></a>
        <a class="avatar-wrap" href="../../../login.html" aria-label="Profile"><img src="../../../img/profile-avatar.png" alt="Profile"><svg class="avatar-placeholder" viewBox="0 0 512 512" fill="#536B75"><path d="M406.5 399.6C387.4 352.9 341.5 320 288 320l-64 0c-53.5 0-99.4 32.9-118.5 79.6C69.9 362.2 48 311.7 48 256C48 141.1 141.1 48 256 48s208 93.1 208 208c0 55.7-21.9 106.2-57.5 143.6zm-40.1 32.7C334.4 452.4 296.6 464 256 464s-78.4-11.6-110.5-31.7c7.3-36.7 39.7-64.3 78.5-64.3l64 0c38.8 0 71.2 27.6 78.5 64.3zM256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-272a40 40 0 1 1 0-80 40 40 0 1 1 0 80zm-64-40a64 64 0 1 0 128 0 64 64 0 1 0-128 0z"/></svg></a>
<a class="nav-icon-btn" href="../../../category.html" aria-label="Menu"><svg viewBox="0 0 448 512" fill="currentColor"><path d="M0 80c0-8.8 7.2-16 16-16H432c8.8 0 16 7.2 16 16s-7.2 16-16 16H16C7.2 96 0 88.8 0 80zM0 240c0-8.8 7.2-16 16-16H432c8.8 0 16 7.2 16 16s-7.2 16-16 16H16c-8.8 0-16-7.2-16-16zM448 400c0 8.8-7.2 16-16 16H16c-8.8 0-16-7.2-16-16s7.2-16 16-16H432c8.8 0 16 7.2 16 16z"/></svg></a>
      </div>
    </nav>
    </header>

    <div class="event-summary">
      <div class="event-thumb">
        <img src="../img/polar-sound-hero.png" alt="Polar Sound Festival">
      </div>
      <div class="event-info">
        <div class="event-name">Occident - Polar Sound 2026</div>
        <div class="event-venue">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z"/><circle cx="12" cy="9" r="2.5"/></svg>
          Baqueira Beret Ski Resort
        </div>
      </div>
    </div>

    <div class="date-row" style="padding:16px; border-bottom:1px solid var(--color-border);">
      <div class="label" style="font-size:14px; font-weight: 600; color:#0079ca; margin-bottom:4px;">Date</div>
      <div class="value" style="font-size:14px;">March 13 &amp; 14, 2026</div>
    </div>

    <div class="cart-section" id="section-tickets">
      <div class="section-header"><h3>Festival Passes</h3><span id="ticket-add-btn"></span></div>
      <div id="ticket-items"></div>
    </div>
    <div class="cart-section" id="section-accommodation">
      <div class="section-header"><h3>Hotel</h3><span id="accommodation-add-btn"></span></div>
      <div id="accommodation-items"></div>
    </div>
    <div class="cart-section" id="section-transportation">
      <div class="section-header"><h3>Transportation</h3><span id="transportation-add-btn"></span></div>
      <div id="transportation-items"></div>
    </div>

    <div class="cart-total">
      <span>Total</span>
      <span id="cart-grand-total">&euro;0.00</span>
    </div>
    <div class="sticky-cta">
      <button type="button" class="cta-btn" id="btn-checkout">Proceed to checkout</button>
    </div>
  </div>

  <script src="../../../js/burger-menu.js"></script>
  <script>
    let cartTickets = [];
    let cartAccommodation = [];
    let cartTransportation = [];

    function loadCart() {
      try {
        cartTickets = JSON.parse(localStorage.getItem('cart_tickets') || '[]');
        cartAccommodation = JSON.parse(localStorage.getItem('cart_accommodation') || '[]');
        cartTransportation = JSON.parse(localStorage.getItem('cart_transportation') || '[]');
      } catch (e) {
        cartTickets = [];
        cartAccommodation = [];
        cartTransportation = [];
      }
    }

    function saveCart() {
      localStorage.setItem('cart_tickets', JSON.stringify(cartTickets));
      localStorage.setItem('cart_accommodation', JSON.stringify(cartAccommodation));
      localStorage.setItem('cart_transportation', JSON.stringify(cartTransportation));
    }

    function renderItem(item, index, type) {
      var trashSvg = '<svg viewBox="0 0 24 24" fill="none" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M3 6h18"/><path d="M8 6V4h8v2"/><path d="M19 6l-1 14H6L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/></svg>';

      var container = document.createElement('div');
      container.className = 'swipe-container';

      var deleteStrip = document.createElement('div');
      deleteStrip.className = 'swipe-delete';
      deleteStrip.innerHTML = trashSvg;
      container.appendChild(deleteStrip);

      var inner = document.createElement('div');
      inner.className = 'swipe-inner';

      var div = document.createElement('div');
      div.className = 'cart-item';
      div.dataset.type = type;
      div.dataset.index = index;
      var qty = item.qty != null ? item.qty : 1;
      var unitPrice = parseFloat(String(item.price).replace(/[^\d.,]/g, '').replace(',', '.')) || 0;
      var totalPrice = unitPrice * qty;
      div.innerHTML =
        '<div class="item-left">' +
          '<div class="item-name">' + (item.name || 'Item') + '</div>' +
          (item.detail ? '<div class="item-detail">' + item.detail + '</div>' : '') +
          '<div class="item-price">€' + totalPrice.toFixed(2) + '</div>' +
        '</div>' +
        '<div class="qty-wrap">' +
          '<button type="button" aria-label="Less">−</button>' +
          '<input type="number" min="0" value="' + qty + '" aria-label="Quantity">' +
          '<button type="button" aria-label="More">+</button>' +
        '</div>';

      inner.appendChild(div);
      container.appendChild(inner);

      var qtyInput = div.querySelector('input');
      var lessBtn = div.querySelector('.qty-wrap button:first-child');
      var moreBtn = div.querySelector('.qty-wrap button:last-child');

      function removeCurrentItem() {
        if (type === 'tickets') cartTickets.splice(index, 1);
        else if (type === 'accommodation') cartAccommodation.splice(index, 1);
        else cartTransportation.splice(index, 1);
        saveCart();
        render();
      }
      function syncLessButtonState() {
        var arr = type === 'tickets' ? cartTickets : type === 'accommodation' ? cartAccommodation : cartTransportation;
        var q = Math.max(0, (arr[index] && arr[index].qty != null ? arr[index].qty : 1));
        if (q <= 0) {
          lessBtn.innerHTML = trashSvg;
          lessBtn.setAttribute('aria-label', 'Remove item');
        } else {
          lessBtn.innerHTML = '−';
          lessBtn.setAttribute('aria-label', 'Less');
        }
      }
      function updateQty(delta) {
        var arr = type === 'tickets' ? cartTickets : type === 'accommodation' ? cartAccommodation : cartTransportation;
        var currentQty = Math.max(0, (arr[index] && arr[index].qty != null ? arr[index].qty : 1));
        if (delta < 0 && currentQty <= 0) { removeCurrentItem(); return; }
        arr[index].qty = Math.max(0, currentQty + delta);
        saveCart();
        render();
      }
      lessBtn.addEventListener('click', function() { updateQty(-1); });
      moreBtn.addEventListener('click', function() { updateQty(1); });
      qtyInput.addEventListener('change', function() {
        var v = parseInt(this.value, 10);
        if (!isNaN(v) && v >= 0) {
          var arr = type === 'tickets' ? cartTickets : type === 'accommodation' ? cartAccommodation : cartTransportation;
          arr[index].qty = v;
          saveCart();
          render();
        }
      });
      syncLessButtonState();

      initSwipe(container, inner, removeCurrentItem);

      return container;
    }

    function getTotal() {
      let t = 0;
      cartTickets.forEach(item => {
        const p = parseFloat(String(item.price).replace(/[^\d.,]/g, '').replace(',', '.')) || 0;
        t += p * (item.qty || 1);
      });
      cartAccommodation.forEach(item => {
        const p = parseFloat(String(item.price).replace(/[^\d.,]/g, '').replace(',', '.')) || 0;
        t += p * (item.qty || 1);
      });
      cartTransportation.forEach(item => {
        const p = parseFloat(String(item.price).replace(/[^\d.,]/g, '').replace(',', '.')) || 0;
        t += p * (item.qty || 1);
      });
      return t;
    }

    function hasAnyCartItems() {
      function hasItems(arr) {
        return arr.some(function(item) { return (item && (item.qty || 1) > 0); });
      }
      return hasItems(cartTickets) || hasItems(cartAccommodation) || hasItems(cartTransportation);
    }

    function getSectionTargets() {
      return {
        tickets: 'polar-sound.html#ticket-section',
        accommodation: 'polar-sound-accommodation.html',
        transportation: '../polar-sound-transportations.html?flow=a2'
      };
    }

    function makeAddBtn(ctaText, href) {
      return '<a class="empty-state-link" href="' + href + '">' + ctaText + '</a>';
    }

    function render() {
      var ticketContainer = document.getElementById('ticket-items');
      var accomContainer = document.getElementById('accommodation-items');
      var transportContainer = document.getElementById('transportation-items');
      var ticketAddBtn = document.getElementById('ticket-add-btn');
      var accomAddBtn = document.getElementById('accommodation-add-btn');
      var transportAddBtn = document.getElementById('transportation-add-btn');
      ticketContainer.innerHTML = '';
      accomContainer.innerHTML = '';
      transportContainer.innerHTML = '';
      ticketAddBtn.innerHTML = '';
      accomAddBtn.innerHTML = '';
      transportAddBtn.innerHTML = '';
      cartTickets.forEach(function(item, i) { ticketContainer.appendChild(renderItem(item, i, 'tickets')); });
      cartAccommodation.forEach(function(item, i) { accomContainer.appendChild(renderItem(item, i, 'accommodation')); });
      cartTransportation.forEach(function(item, i) { transportContainer.appendChild(renderItem(item, i, 'transportation')); });
      var targets = getSectionTargets();
      if (cartTickets.length === 0) ticketAddBtn.innerHTML = makeAddBtn('Add passes', targets.tickets);
      if (cartAccommodation.length === 0) accomAddBtn.innerHTML = makeAddBtn('Add hotel', targets.accommodation);
      if (cartTransportation.length === 0) transportAddBtn.innerHTML = makeAddBtn('Add transport', targets.transportation);
      document.getElementById('cart-grand-total').textContent = '€' + getTotal().toFixed(2);
    }

    function initSwipe(container, inner, onDelete) {
      var startX = 0, startY = 0, currentX = 0, locked = false;
      inner.addEventListener('touchstart', function(e) {
        startX = e.touches[0].clientX;
        startY = e.touches[0].clientY;
        currentX = 0;
        locked = false;
        container.classList.add('active-swipe');
        inner.classList.add('swiping');
      }, { passive: true });
      inner.addEventListener('touchmove', function(e) {
        if (locked) return;
        var dx = e.touches[0].clientX - startX;
        var dy = e.touches[0].clientY - startY;
        if (Math.abs(dy) > Math.abs(dx) && currentX === 0) { locked = true; container.classList.remove('active-swipe'); return; }
        currentX = Math.min(0, dx);
        inner.style.transform = 'translateX(' + currentX + 'px)';
      }, { passive: true });
      inner.addEventListener('touchend', function() {
        inner.classList.remove('swiping');
        if (currentX < -80) {
          inner.style.transition = 'transform 0.25s ease';
          inner.style.transform = 'translateX(-100%)';
          setTimeout(function() { onDelete(); }, 250);
        } else {
          inner.style.transform = '';
          container.classList.remove('active-swipe');
        }
      });
    }

    loadCart();
    render();

    document.getElementById('btn-checkout').addEventListener('click', function() {
      if (!hasAnyCartItems()) {
        window.location.href = (window.flowHref||function(u){return u})('polar-sound.html#ticket-section');
        return;
      }
      try { sessionStorage.setItem('checkout_scroll_target', 'payment'); } catch (e) {}
      window.location.href = (window.flowHref||function(u){return u})('checkout.html');
    });
  </script>
  <script>if(localStorage.getItem('fever_logged_in')==='true'){document.documentElement.classList.add('u-in');var a=document.querySelector('.avatar-wrap');if(a){a.href='../profile.html';}}</script>
  <script src="../../../js/flow-param.js"></script>
</body>
</html>
