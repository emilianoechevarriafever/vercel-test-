<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/png" sizes="32x32" href="./favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./favicons/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="./favicons/apple-touch-icon.png">
  <link rel="shortcut icon" href="./favicon.ico">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Occident - Polar Sound 2026: Hotel</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
    /* Fever Design System */
    :root {
      --color-primary: #0079ca;
      --color-primary-weak: #e6f4ff;
      --color-primary-light: #f2fbfd;
      --color-text: #031419;
      --color-text-subtle: #536b75;
      --color-text-disable: #a7b2ba;
      --color-border: #ccd2d8;
      --color-border-light: #dde1e4;
      --color-accent: #6f41d7;
      --color-bg: #ffffff;
      --color-bg-disable: #f6f6f6;
      --color-bg-neutral: #f2f3f3;
      --font: 'Montserrat', sans-serif;
  --color-primary-hover: #0068b0;
  --color-text-main: #031419;
  --color-danger: #eb0052;
  --color-success: #24a865;
  --color-warning: #ff8c00;
  --color-rating: #f5a623;
  --color-urgency-bg: #f5e6dc;
  --color-urgency-text: #9f5800;
  --elevation-02: 0 2px 4px rgba(0,0,0,0.12);
  --elevation-sheet: 0 -4px 20px rgba(0,0,0,0.12);
  --focus-ring-primary: 0 0 0 4px rgba(0,121,202,0.32);
  --shadow-primary: 0 3px 3px rgba(0,121,202,0.15);
  --ticket-border: #ccd2d8;
}
    html { scroll-behavior: smooth; -webkit-tap-highlight-color: transparent; }
    body { font-family:var(--font); background:var(--color-bg-neutral); display:flex; justify-content:center; color:var(--color-text); overflow-x:hidden; }
    .phone { width:393px; max-width:100vw; background:var(--color-bg); min-height:100vh; position:relative; }

    .status-bar { display:flex; align-items:center; justify-content:space-between; padding:6px 16px 4px; background:white; }
    .status-bar .time { font-weight:600; font-size:20px; letter-spacing:-0.68px; }
    .status-bar .icons { display:flex; gap:4px; align-items:center; }
    .status-bar .icons svg { height:12px; }

    .sticky-header { position:sticky; top:0; z-index:100; background:#fff; }
    .navbar { display:flex; align-items:center; justify-content:space-between; padding:10px 16px; background:#fff; border-top:none; border-bottom:1px solid var(--color-border); }
    .navbar .logo-link { text-decoration:none; display:flex; align-items:center; }
    .navbar .logo-link img { height:38px; width:auto; display:block; object-fit:contain; }
    .nav-icons { display:flex; align-items:center; gap:20px; }
    .nav-icons svg { height:24px; width:auto; color:var(--color-text); cursor:pointer; }
    .nav-icon-btn{all:unset;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;color:inherit;width:24px;height:24px;flex-shrink:0;box-sizing:border-box;overflow:visible}
    .nav-icon-btn svg { height:24px; width:auto; color:var(--color-text); }
    .avatar-wrap{all:unset;position:relative;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;width:24px;height:24px;flex-shrink:0;box-sizing:border-box}
    .avatar-wrap img { width:24px; height:24px; border-radius:50%; object-fit:cover; display:none;}
    .avatar-wrap .avatar-placeholder { display:flex;}
    html.u-in .avatar-wrap::after { content:''; position:absolute; top:-1px; right:-1px; width:8px; height:8px; background:var(--color-success); border:1.5px solid white; border-radius:50%; }
    html.u-in .avatar-wrap img{display:block}
    html.u-in .avatar-wrap .avatar-placeholder{display:none}
    /* Hero with overlay */
    .hero { position:relative; width:100%; height:390px; overflow:hidden; }
    .hero img.hero-bg, .hero video.hero-bg { width:100%; height:100%; object-fit:cover; position:absolute; inset:0; }
    .hero img.hero-bg { z-index:0; }
    .hero video.hero-bg { z-index:1; }
    .hero .overlay { position:absolute; inset:0; background:linear-gradient(180deg, rgba(6,35,44,0.3) 0%, rgba(6,35,44,0.6) 100%); display:flex; flex-direction:column; align-items:center; justify-content:center; gap:8px; pointer-events:none; }
    .hero .overlay .brand-text { font-family:var(--font); font-size:32px; font-weight: 600; color:white; letter-spacing:4px; text-transform:uppercase; text-shadow:0 2px 20px rgba(0,0,0,0.5); }
    .hero .overlay .brand-sub { font-family:var(--font); font-size:16px; font-weight:600; color:rgba(255,255,255,0.92); letter-spacing:2px; }
    .hero .side-buttons { position:absolute; top:16px; right:16px; display:flex; flex-direction:column; gap:12px; z-index:2; }
    .hero .side-btn { width:40px; height:40px; background:white; border:1px solid rgba(0,0,0,0.1); border-radius:50%; display:flex; align-items:center; justify-content:center; box-shadow:var(--elevation-02); cursor:pointer; }
    .hero .side-btn svg { width:20px; height:20px; color:var(--color-text); }
    .hero .side-btn.liked svg { fill:var(--color-danger); stroke:var(--color-danger); color:var(--color-danger); }
    .hero .shadow-overlay { position:absolute; bottom:0; left:0; right:0; height:135px; background:transparent; display:flex; flex-direction:column; justify-content:flex-end; align-items:flex-end; padding:0 16px 16px; gap:16px; z-index:2; }
    .hero .gallery-btn { display:inline-flex; align-items:center; gap:4px; background:#fff; border:none; border-radius:4rem; padding:0 12px; height:32px; font-family:var(--font); font-weight:600; font-size:14px; line-height:20px; cursor:pointer; color:var(--color-text-main); pointer-events:auto; box-shadow:var(--shadow-primary); }
    .hero .gallery-btn svg { width:16px; height:16px; }
    .hero .slide-indicators { display:flex; gap:4px; width:100%; }
    /* Barras horizontales (Figma), no círculos */
    .hero .slide-indicators .bar { flex:1; min-width:0; height:3px; border-radius:64px; background:rgba(255,255,255,0.5); }
    .hero .slide-indicators .bar.active { background:white; }
    .hero .rounded-top { position:absolute; bottom:0; left:0; right:0; height:8px; background:white; border-radius:8px 8px 0 0; z-index:2; }

    .title-section { padding:16px; }
        /* Tickets Selling Fast — Figma 778-27021 (Channel Filter) */
    .tag-selling { display:inline-flex; align-items:center; min-height:20px; padding:4px 12px; margin-bottom:12px; background:var(--color-warning); border-radius:4px; font-family:var(--font); font-size:12px; font-weight:400; line-height:16px; color:var(--color-text-main); }
    .selling-fast-banner { display:flex; align-items:center; justify-content:center; gap:8px; margin:4px 0 20px; padding:12px 16px; background:var(--color-urgency-bg); border-radius:8px; font-family:var(--font); font-size:14px; font-weight:600; line-height:20px; color:var(--color-text-subtle); }
    .selling-fast-banner .selling-fast-icon { width:20px; height:20px; flex-shrink:0; color:var(--color-urgency-text); }
    .title-section h1 { font-size:20px; font-weight:600; line-height:24px; margin-bottom:4px; }
    .divider { height:1px; background:var(--color-border); margin:0 16px; }

    .description { padding: 24px 16px; font-size:14px; line-height:20px; }
    .description p { margin-bottom:12px; }
    .description .subtitle { font-weight:600; font-size:16px; margin-bottom:8px; margin-top:16px; }
    .description ul { padding-left:20px; margin-bottom:12px; }
    .description ul li { margin-bottom:4px; }
    .description a { color:var(--color-primary); text-decoration:underline; pointer-events:none; cursor:default; }

    .section-header { display:flex; align-items:center; gap:8px; padding:8px 16px; background:var(--color-bg-neutral); }
    .section-header img { width:24px; height:24px; flex-shrink:0; display:block; object-fit:contain; }
    .section-header h2 { font-size:20px; font-weight:400; line-height:24px; flex:1; color:var(--color-text-main); }

    .ticket-selector { padding:0 16px 16px; border-bottom:1px solid var(--color-border); }

    /* Pill levels */
    .pill-level { display:flex; gap:12px; align-items:center; justify-content:flex-start; padding:16px 0; border-bottom:1px solid var(--color-border); overflow-x:auto; overflow-y:hidden; scrollbar-width:none; -webkit-overflow-scrolling:touch; touch-action:pan-x; }
    .pill-level.centered { justify-content:center; }
    .pill-level::-webkit-scrollbar { display:none; }
    .ticket-pill { flex-shrink:0; padding:10px 16px; border:1px solid var(--color-border); border-radius:8px; font-size:14px; font-weight:600; color:var(--color-text); background:white; cursor:pointer; white-space:nowrap; text-align:center; transition:all 0.15s; }
    .ticket-pill.active { border-color:var(--color-primary); color:var(--color-primary); background:var(--color-primary-weak); }
    .ticket-pill.disabled { color:var(--color-text-disable); border-color:var(--color-border); pointer-events:none; }
    .pill-arrow { flex-shrink:0; width:32px; height:32px; display:none; align-items:center; justify-content:center; cursor:pointer; }
    .pill-arrow.visible { display:flex; }
    .pill-arrow svg { width:16px; height:16px; color:var(--color-text-subtle); }

    /* Ticket rows — coupon style */
    #room-rows { margin-top:16px; }
    .ticket-row { --ticket-border:var(--color-border); display:flex; align-items:stretch; min-height:92px; margin-bottom:16px; position:relative; border-radius:8px; overflow:visible; background:transparent; }
    .ticket-row::after { content:''; position:absolute; right:136px; top:8px; bottom:8px; width:1px; background-image:repeating-linear-gradient(to bottom, var(--ticket-border) 0 2px, transparent 2px 4px); background-repeat:no-repeat; background-size:1px 100%; transform:translateX(50%); pointer-events:none; z-index:2; }
    .ticket-row .ticket-content { flex:1; padding:12px; display:flex; flex-direction:column; justify-content:flex-start; gap:8px; border:1px solid var(--ticket-border); border-right:none; border-radius:8px 0 0 8px; background:#fff; min-height:92px; }
    .ticket-row .ticket-name { font-size:14px; font-weight:600; line-height:20px; color:var(--color-text); }
    .ticket-row .ticket-more,
    .ticket-row .ticket-info-toggle { font-size:12px; font-weight:600; line-height:16px; color:var(--color-primary); text-decoration:none; padding:2px 0; cursor:pointer; background:none; border:none; font-family:var(--font); text-align:left; align-self:flex-start; }
    .ticket-row .ticket-info-detail { display:none; margin-top:8px; padding-top:6px; border-top:1px solid var(--color-border); font-size:14px; line-height:20px; color:var(--color-text); }
    .ticket-row.ticket-info-expanded .ticket-info-detail { display:block; }
    .ticket-row .ticket-info-detail .ticket-info-intro { margin-bottom:8px; }
    .ticket-row .ticket-info-detail ul { margin:0; padding-left:16px; list-style:disc; }
    .ticket-row .ticket-info-detail li { margin-bottom:2px; }
    .ticket-row .ticket-price { font-size:14px; font-weight:600; color:var(--color-text); margin-top:auto; }
    .ticket-row .ticket-selector-right { width:136px; flex-shrink:0; display:flex; align-items:center; justify-content:center; padding:12px; border:1px solid var(--ticket-border); border-left:none; border-radius:0 8px 8px 0; background:#fff; position:relative; }
    .ticket-row .stepper { display:flex; align-items:center; gap:4px; padding:0; background:transparent; border:none; }
    .ticket-amount .amt-btn { width:32px; height:32px; border-radius:50%; border:none; display:flex; align-items:center; justify-content:center; cursor:pointer; font-size:20px; font-weight:400; transition:background 0.15s; background:var(--color-bg-neutral); color:var(--color-text-disable); }
    .ticket-amount .amt-count { width:40px; text-align:center; font-size:16px; font-weight:600; }

    /* Selected state */
    .ticket-row.selected { --ticket-border:var(--color-primary); }
    .ticket-row.selected .ticket-selector-right { background:var(--color-primary-weak); }
    .ticket-row.selected .stepper { background:#fff; border-radius:64px; padding:4px 6px; }
    .ticket-row.selected .amt-btn { background:var(--color-primary-weak); color:var(--color-primary); }

    /* Ticket notch divider */
    .ticket-row .ticket-notch { position:absolute; right:136px; top:0; bottom:0; width:16px; pointer-events:none; z-index:3; transform: translateX(50%); }
    .ticket-row .ticket-notch::before,
    .ticket-row .ticket-notch::after { content:''; position:absolute; left:0; width:16px; height:8px; background:var(--color-bg); box-sizing:border-box; }
    .ticket-row .ticket-notch::before { top:0; border:1px solid var(--ticket-border); border-top:none; border-radius:0 0 8px 8px; }
    .ticket-row .ticket-notch::after { bottom:0; border:1px solid var(--ticket-border); border-bottom:none; border-radius:8px 8px 0 0; }

    /* Sold out */
    .ticket-row.soldout { opacity:0.6; pointer-events:none; }
    .ticket-row.soldout::after { display:none; }
    .ticket-row.soldout .ticket-selector-right { display:none; }
    .ticket-row.soldout .ticket-notch { display:none; }
    .ticket-row.soldout .ticket-content { border-radius:8px; border-right:1px solid var(--ticket-border); }
    .ticket-row .soldout-tag { display:none; position:absolute; right:12px; top:50%; transform:translateY(-50%); background:var(--color-bg-disable); color:var(--color-text-disable); font-size:12px; font-weight:600; padding:6px 14px; border-radius:4px; }
    .ticket-row.soldout .soldout-tag { display:block; }

    .cta-primary { width:100%; height:48px; background:var(--color-primary); border:none; border-radius:64px; color:white; font-family:var(--font); font-weight:600; font-size:16px; cursor:pointer; margin-bottom:12px; transition:background 0.15s; display:none; }
    .cta-primary:hover { background:var(--color-primary-hover); }
    .cta-secondary { width:100%; height:48px; background:white; border:1.5px solid var(--color-border); border-radius:64px; color:var(--color-text); font-family:var(--font); font-weight:600; font-size:14px; cursor:pointer; display:flex; align-items:center; justify-content:center; gap:8px; }
    .cta-secondary svg { width:18px; height:18px; }

    .reviews { padding: 24px 16px; }
    .reviews h3 { font-size:20px; font-weight:600; margin-bottom:16px; }
    .rating-big { display:flex; align-items:center; gap:8px; margin-bottom:16px; }
    .rating-big .score { font-size:24px; font-weight: 600; }
    .rating-big .stars { color:var(--color-rating); font-size:16px; letter-spacing:2px; }
    .rating-big .count { font-size:14px; color:var(--color-text-subtle); }
    .review-card { border-bottom:1px dashed var(--color-border-light); padding:12px 0; }
    .review-card:last-child { border-bottom:none; }
    .review-card .reviewer { font-size:14px; font-weight:600; }
    .review-card .review-date { font-size:12px; color:var(--color-text-subtle); margin:2px 0 6px; }
    .review-card .review-text { font-size:14px; line-height:20px; }

    .help-section { border-bottom:1px solid var(--color-border); }
    .help-content { padding:16px; font-size:14px; line-height:20px; color:#031419; }
    .help-content a { color:#0079ca; text-decoration:underline; }

    .location { padding: 24px 16px; }
    .location .loc-name { font-weight:600; font-size:14px; margin-bottom:4px; }
    .location .loc-address { font-size:14px; color:var(--color-text-subtle); margin-bottom:12px; }
    .location .map-placeholder { width:100%; height:160px; background:var(--color-border-light); border-radius:8px; overflow:hidden; }
    .location .map-placeholder img { width:100%; height:100%; object-fit:cover; }

    .footer { background:var(--color-text-main); color:white; padding:32px 16px 80px; }
    .footer-cols { display:flex; justify-content:space-between; margin-bottom:24px; }
    .footer-col h5 { font-size:14px; font-weight: 600; margin-bottom:8px; }
    .footer-col ul { list-style:none; }
    .footer-col ul li { font-size:14px; line-height:20px; margin-bottom:4px; }
    .footer-col ul li a { color:rgba(255,255,255,0.7); text-decoration:none; transition:color 0.15s; }
    .footer-col ul li a:hover { color:white; }
    .footer .legal { border-top:1px solid rgba(255,255,255,0.15); padding-top:16px; font-size:12px; color:rgba(255,255,255,0.5); }
    .footer .legal a { color:white; }

    .sticky-cta { position:fixed; bottom:0; width:393px; max-width:100vw; z-index:200; background:transparent; padding:12px 16px max(12px, env(safe-area-inset-bottom)); }
    .sticky-cta .cta-btn { width:100%; height:48px; background:var(--color-primary); border:2px solid transparent; border-radius:64px; color:#fff; font-family:var(--font); font-weight:600; font-size:16px; line-height:24px; cursor:pointer; transition:background 0.15s, border-color 0.15s, box-shadow 0.15s, color 0.15s, opacity 0.15s; outline:none; }
    .sticky-cta .cta-btn:hover { background:var(--color-primary); }
    .sticky-cta .cta-btn:focus-visible { border-color:var(--color-primary-hover); box-shadow:var(--focus-ring-primary); }
    .sticky-cta .cta-btn:active { background:var(--color-primary); opacity:0.85; }
    .sticky-cta .cta-btn:disabled, .sticky-cta .cta-btn.disabled { background:var(--color-bg-neutral); color:var(--color-text-disable); border-color:transparent; box-shadow:none; cursor:default; opacity:1; }

    /* Flow stepper — Figma Progress Indicator */
    .flow-stepper { display:flex; align-items:flex-start; justify-content:space-between; padding:12px 16px; background:#fff; border-bottom:1px solid var(--color-border); }
    .flow-stepper .step { display:flex; flex-direction:column; align-items:center; gap:4px; flex:1; min-width:0; position:relative; }
    .flow-stepper .step::after { content:''; position:absolute; top:9px; left:50%; width:100%; height:2px; background:var(--color-border); z-index:0; }
    .flow-stepper .step:last-child::after { display:none; }
    .flow-stepper .step.done::after { background:var(--color-primary); }
    .flow-stepper .step.current::after { background:var(--color-border); }
    .flow-stepper .step .dot { width:20px; height:20px; border-radius:50%; border:2px solid var(--color-border); background:#fff; display:flex; align-items:center; justify-content:center; z-index:1; position:relative; font-size:0; color:transparent; box-sizing:border-box; }
    .flow-stepper .step.done .dot { border-color:var(--color-primary); background:#fff; }
    .flow-stepper .step.done .dot::before { content:''; display:block; width:10px; height:7px; background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 11 8' fill='none'%3E%3Cpath d='M1 3.5L4 6.5L10 1' stroke='%230089e3' stroke-width='1.8' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E") center/contain no-repeat; }
    .flow-stepper .step.done.skipped .dot { border-color:var(--color-primary); }
    .flow-stepper .step.done.skipped .dot::before { width:8px; height:2px; background:var(--color-primary); border-radius:4px; }
    .flow-stepper .step.current .dot { border-color:var(--color-primary); background:#fff; }
    .flow-stepper .step.current .dot::before { content:''; display:block; width:10px; height:10px; border-radius:50%; background:var(--color-primary); }
    .flow-stepper .step .label { font-family:var(--font); font-size:12px; font-weight:600; line-height:16px; color:var(--color-text-disable); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:100%; }
    .flow-stepper .step.done .label { color:var(--color-text-subtle); }
    .flow-stepper .step.current .label { color:var(--color-text-subtle); }
    .flow-stepper a.step { text-decoration:none; color:inherit; cursor:pointer; }
    .flow-stepper a.step.disabled { pointer-events:none; cursor:default; opacity:0.45; }
    .flow-stepper.stepper-hidden { display:none !important; }

    /* Cross-sell bottom sheet (Option H) */
    .crosssell-overlay { position:fixed; inset:0; background:rgba(3,20,25,0.35); opacity:0; pointer-events:none; transition:opacity 0.15s ease; z-index:350; }
    .crosssell-overlay.open { opacity:1; pointer-events:auto; }
    .crosssell-sheet { position:fixed; left:50%; bottom:0; transform:translateX(-50%) translateY(100%); width:393px; max-width:100vw; background:#fff; border-radius:16px 16px 0 0; z-index:351; padding:16px; transition:transform 0.3s ease; box-shadow:var(--elevation-sheet); }
    .crosssell-sheet.open { transform:translateX(-50%) translateY(0); }
    .crosssell-sheet .handle { width:36px; height:4px; border-radius:4px; background:var(--color-border); margin:0 auto 14px; }
    .crosssell-sheet h3 { font-size:20px; font-weight: 600; text-align:center; margin-bottom:16px; }
    .crosssell-sheet .hub-actions { display:flex; flex-direction:column; gap:8px; }
    .crosssell-sheet .hub-btn { width:100%; min-height:44px; border-radius:64px; border:1px solid var(--color-border); background:#fff; color:var(--color-text); font-family:var(--font); font-size:14px; font-weight:600; cursor:pointer; padding:10px 16px; }
    .crosssell-sheet .hub-btn.primary { background:var(--color-primary); border-color:var(--color-primary); color:#fff; }
    .crosssell-sheet .hub-btn.secondary { background:#fff; border-color:var(--color-border); color:var(--color-text); display:inline-flex; align-items:center; justify-content:center; gap:8px; }
    .crosssell-sheet .hub-btn.secondary svg { width:20px; height:20px; flex-shrink:0; stroke:currentColor; fill:none; stroke-width:2; }

    /* === FULLSCREEN GALLERY === */
    .fs-gallery { position:fixed; inset:0; z-index:9999; background:#fff; display:none; flex-direction:column; }
    .fs-gallery.open { display:flex; }
    .fs-gallery-topbar { position:absolute; top:0; right:0; z-index:2; padding:12px 16px; }
    .fs-gallery-close { width:40px; height:40px; border:none; background:transparent; cursor:pointer; display:flex; align-items:center; justify-content:center; }
    .fs-gallery-close svg { width:28px; height:28px; color:var(--color-text-main); }
    .fs-gallery-viewport { flex:1; position:relative; overflow:hidden; display:flex; align-items:center; }
    .fs-gallery-track { display:flex; height:100%; width:100%; transition:transform 0.3s cubic-bezier(.4,0,.2,1); }
    .fs-gallery-track.no-transition { transition:none; }
    .fs-gallery-slide { min-width:100%; height:100%; display:flex; align-items:center; justify-content:center; }
    .fs-gallery-slide img { max-width:100%; max-height:100%; object-fit:contain; user-select:none; -webkit-user-drag:none; border-radius:4px; }
    .fs-gallery-arrow { position:absolute; top:50%; transform:translateY(-50%); z-index:2; width:44px; height:44px; border:none; background:rgba(0,0,0,0.3); border-radius:8px; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:background 0.15s; }
    .fs-gallery-arrow:active { background:rgba(0,0,0,0.4); }
    .fs-gallery-arrow svg { width:28px; height:28px; color:#fff; }
    .fs-gallery-arrow.prev { left:8px; }
    .fs-gallery-arrow.next { right:8px; }
    .fs-gallery-thumbs { display:flex; gap:8px; padding:12px 16px max(16px, env(safe-area-inset-bottom)); flex-shrink:0; overflow-x:auto; -webkit-overflow-scrolling:touch; scrollbar-width:none; }
    .fs-gallery-thumbs::-webkit-scrollbar { display:none; }
    .fs-gallery-thumb { width:72px; height:72px; min-width:72px; border-radius:8px; overflow:hidden; cursor:pointer; border:2px solid transparent; transition:border-color 0.15s; }
    .fs-gallery-thumb.active { border-color:var(--color-primary); }
    .fs-gallery-thumb img { width:100%; height:100%; object-fit:cover; }

    @media (max-width:393px) { .phone { width:100vw; } .sticky-cta { width:100vw; } .crosssell-sheet { width:100vw; } }
    /* Tap feedback */
    .nav-icon-btn:active { opacity:0.6; }
    .ticket-pill:active { transform:scale(0.96); }
  </style>
  <link rel="stylesheet" href="css/navbar.css">
<script>if(localStorage.getItem("fever_logged_in")==="true")document.documentElement.classList.add("u-in")</script>
</head>
<body>
  <div class="phone">

    <header class="sticky-header">
    <nav class="navbar">
      <a href="home.html" class="logo-link" id="nav-logo-link"><img src="img/fever-logo.svg" alt="Fever"></a>
      <div class="nav-icons">
        <a class="nav-icon-btn" href="search.html" aria-label="Search"><svg viewBox="0 0 512 512" fill="currentColor"><path d="M384 208A176 176 0 1 0 32 208a176 176 0 1 0 352 0zM343.3 366C307 397.2 259.7 416 208 416C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208c0 51.7-18.8 99-50 135.3L507.3 484.7c6.2 6.2 6.2 16.4 0 22.6s-16.4 6.2-22.6 0L343.3 366z"/></svg></a>
        <a class="nav-icon-btn" href="home.html" aria-label="Location"><svg viewBox="0 0 384 512" fill="currentColor"><path d="M352 192c0-88.4-71.6-160-160-160S32 103.6 32 192c0 15.6 5.4 37 16.6 63.4c10.9 25.9 26.2 54 43.6 82.1c34.1 55.3 74.4 108.2 99.9 140c25.4-31.8 65.8-84.7 99.9-140c17.3-28.1 32.7-56.3 43.6-82.1C346.6 229 352 207.6 352 192zm32 0c0 87.4-117 243-168.3 307.2c-12.3 15.3-35.1 15.3-47.4 0C117 435 0 279.4 0 192C0 86 86 0 192 0S384 86 384 192zm-240 0a48 48 0 1 0 96 0 48 48 0 1 0 -96 0zm48 80a80 80 0 1 1 0-160 80 80 0 1 1 0 160z"/></svg></a>
        <a class="nav-icon-btn" href="favorites.html" aria-label="Favorites"><svg viewBox="0 0 512 512" fill="currentColor"><path d="M244 130.6l-12-13.5-4.2-4.7c-26-29.2-65.3-42.8-103.8-35.8c-53.3 9.7-92 56.1-92 110.3v3.5c0 32.3 13.4 63.1 37.1 85.1L253 446.8c.8 .7 1.9 1.2 3 1.2s2.2-.4 3-1.2L443 275.5c23.6-22 37-52.8 37-85.1v-3.5c0-54.2-38.7-100.6-92-110.3c-38.5-7-77.8 6.6-103.8 35.8l-4.2 4.7-12 13.5c-3 3.4-7.4 5.4-12 5.4s-8.9-2-12-5.4zm34.9-57.1C311 48.4 352.7 37.7 393.7 45.1C462.2 57.6 512 117.3 512 186.9v3.5c0 36-13.1 70.6-36.6 97.5c-3.4 3.8-6.9 7.5-10.7 11l-184 171.3c-.8 .8-1.7 1.5-2.6 2.2c-6.3 4.9-14.1 7.5-22.1 7.5c-9.2 0-18-3.5-24.8-9.7L47.2 299c-3.8-3.5-7.3-7.2-10.7-11C13.1 261 0 226.4 0 190.4v-3.5C0 117.3 49.8 57.6 118.3 45.1c40.9-7.4 82.6 3.2 114.7 28.4c6.7 5.3 13 11.1 18.7 17.6l4.2 4.7 4.2-4.7c4.2-4.7 8.6-9.1 13.3-13.1c1.8-1.5 3.6-3 5.4-4.5z"/></svg></a>
        <a class="avatar-wrap" href="login.html" aria-label="Profile"><img src="img/profile-avatar.png" alt="Profile"><svg class="avatar-placeholder" viewBox="0 0 512 512" fill="var(--color-text-subtle)"><path d="M406.5 399.6C387.4 352.9 341.5 320 288 320l-64 0c-53.5 0-99.4 32.9-118.5 79.6C69.9 362.2 48 311.7 48 256C48 141.1 141.1 48 256 48s208 93.1 208 208c0 55.7-21.9 106.2-57.5 143.6zm-40.1 32.7C334.4 452.4 296.6 464 256 464s-78.4-11.6-110.5-31.7c7.3-36.7 39.7-64.3 78.5-64.3l64 0c38.8 0 71.2 27.6 78.5 64.3zM256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-272a40 40 0 1 1 0-80 40 40 0 1 1 0 80zm-64-40a64 64 0 1 0 128 0 64 64 0 1 0-128 0z"/></svg></a>
<a class="nav-icon-btn" href="category.html" aria-label="Menu"><svg viewBox="0 0 448 512" fill="currentColor"><path d="M0 80c0-8.8 7.2-16 16-16H432c8.8 0 16 7.2 16 16s-7.2 16-16 16H16C7.2 96 0 88.8 0 80zM0 240c0-8.8 7.2-16 16-16H432c8.8 0 16 7.2 16 16s-7.2 16-16 16H16c-8.8 0-16-7.2-16-16zM448 400c0 8.8-7.2 16-16 16H16c-8.8 0-16-7.2-16-16s7.2-16 16-16H432c8.8 0 16 7.2 16 16z"/></svg></a>
      </div>
    </nav>
    <div class="flow-stepper">
      <a href="polar-sound.html#ticket-section" id="stepper-step1" class="step done"><span class="dot"></span><span class="label">Tickets</span></a>
      <div class="step current"><span class="dot">2</span><span class="label">Hotel</span></div>
      <a href="polar-sound-transportations.html" class="step" id="stepper-step3"><span class="dot">3</span><span class="label">Transport</span></a>
      <a href="checkout.html" class="step" id="stepper-step4"><span class="dot">4</span><span class="label">Checkout</span></a>
    </div>
    </header>

    <!-- Hero Gallery (Figma Channel Filter) -->
    <div class="hero">
      <img class="hero-bg" src="img/baqueira-hotel.png" alt="Hotel Baqueira Beret">
      <video class="hero-bg" src="https://applications-media.feverup.com/video/upload/f_auto,w_900,h_500,c_fill/fever2/plan/video/56fb36f8-a9b0-11f0-8820-5638fea30a91.mp4" poster="https://applications-media.feverup.com/image/upload/f_auto,w_900,h_500,c_fill/fever2/plan/photo/177ff826-8d70-11f0-b4b3-b26529526013.jpg" autoplay muted loop playsinline></video>
      <div class="overlay">
        <div class="brand-text">POLAR SOUND</div>
        <div class="brand-sub">&#10070;</div>
      </div>
      <div class="side-buttons">
        <button type="button" class="side-btn" aria-label="Like"><svg viewBox="0 0 512 512" fill="currentColor"><path d="M244 130.6l-12-13.5-4.2-4.7c-26-29.2-65.3-42.8-103.8-35.8c-53.3 9.7-92 56.1-92 110.3v3.5c0 32.3 13.4 63.1 37.1 85.1L253 446.8c.8 .7 1.9 1.2 3 1.2s2.2-.4 3-1.2L443 275.5c23.6-22 37-52.8 37-85.1v-3.5c0-54.2-38.7-100.6-92-110.3c-38.5-7-77.8 6.6-103.8 35.8l-4.2 4.7-12 13.5c-3 3.4-7.4 5.4-12 5.4s-8.9-2-12-5.4zm34.9-57.1C311 48.4 352.7 37.7 393.7 45.1C462.2 57.6 512 117.3 512 186.9v3.5c0 36-13.1 70.6-36.6 97.5c-3.4 3.8-6.9 7.5-10.7 11l-184 171.3c-.8 .8-1.7 1.5-2.6 2.2c-6.3 4.9-14.1 7.5-22.1 7.5c-9.2 0-18-3.5-24.8-9.7L47.2 299c-3.8-3.5-7.3-7.2-10.7-11C13.1 261 0 226.4 0 190.4v-3.5C0 117.3 49.8 57.6 118.3 45.1c40.9-7.4 82.6 3.2 114.7 28.4c6.7 5.3 13 11.1 18.7 17.6l4.2 4.7 4.2-4.7c4.2-4.7 8.6-9.1 13.3-13.1c1.8-1.5 3.6-3 5.4-4.5z"/></svg></button>
        <button type="button" class="side-btn" aria-label="Share"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8M16 6l-4-4-4 4M12 2v13"/></svg></button>
      </div>
      <div class="shadow-overlay">
        <button type="button" class="gallery-btn"><svg viewBox="0 0 512 512" fill="currentColor"><path d="M224 80c0-26.5-21.5-48-48-48H80C53.5 32 32 53.5 32 80v96c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48V80zm0 256c0-26.5-21.5-48-48-48H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48V336zM288 80v96c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48H336c-26.5 0-48 21.5-48 48zM480 336c0-26.5-21.5-48-48-48H336c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48V336z"/></svg>Gallery</button>
        <div class="slide-indicators">
          <div class="bar active"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
        </div>
      </div>
      <div class="rounded-top"></div>
    </div>

    <div class="title-section">
      <div class="tag-selling">Tickets Selling Fast</div>
      <h1>Occident - Polar Sound 2026: Hotel</h1>
    </div>
    <div class="description">
      <p>&#10071; <strong>By booking your hotel you are also purchasing your 2-day festival pass.</strong></p>
      <p>&#127915; Hotel + Pass with 2-day access. Choose from travel options for 1 to 6 people, 2 or 3-night stays, and a wide variety of hotels and apartments.</p>
      <p class="subtitle">&#127908; Daily line-up</p>
      <ul>
        <li><strong>Friday 13th:</strong> Lori Meyers, Silo&eacute;, Fuzz by Dj Nano, Leire Mart&iacute;nez, Paula Mattheus</li>
        <li><strong>Saturday 14th:</strong> Juan Mag&aacute;n, Taburete, Marlon, Sexy Zebras, Hey Kid, Besmaya</li>
      </ul>
    </div>
<!-- Ticket Selector -->
    <div class="section-header" id="ticket-section">
      <img src="img/fa-ticket.svg" alt="">
      <h2>Select date and session</h2>
    </div>

    <div class="ticket-selector">
      <!-- Level 1: Travelers -->
      <div class="pill-level" id="level-travelers">
        <div class="ticket-pill active" data-value="2">Trip 2 people + Pass</div>
        <div class="ticket-pill" data-value="3">Trip 3 people + Pass</div>
        <div class="ticket-pill" data-value="4">Trip 4 people + Pass</div>
        <div class="pill-arrow"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg></div>
      </div>

      <!-- Level 2: Nights -->
      <div class="pill-level" id="level-nights">
        <div class="ticket-pill active" data-value="3">3 nights (Mar 12, 13 &amp; 14)</div>
        <div class="ticket-pill" data-value="2">2 nights (Mar 13 &amp; 14)</div>
      </div>

      <!-- Level 4: Hotel/Apartment name -->
      <div class="pill-level" id="level-name">
        <div class="pill-arrow" style="transform:rotate(180deg)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg></div>
        <!-- Populated by JS -->
      </div>

      <!-- Room rows (populated by JS) -->
      <div id="room-rows"></div>

      <!-- Selling fast -->
      <div class="selling-fast-banner"><svg class="selling-fast-icon" viewBox="0 0 12 16" fill="currentColor" aria-hidden="true"><path d="M11.625 8.03125C11.875 8.6875 12 9.375 12 10.0625C12 13.3438 9.28125 16 6 16C2.6875 16 0 13.3438 0 10.0625C0 9.375 0.09375 8.6875 0.34375 8.03125L0.375 7.96875C1.4375 5.03125 3.1875 2.40625 5.4375 0.28125L5.5625 0.1875C5.65625 0.0625 5.8125 0 6 0C6.15625 0 6.3125 0.0625 6.40625 0.1875L6.53125 0.28125C8.8125 2.40625 10.5312 5.03125 11.5938 7.96875L11.625 8.03125ZM5.875 4.65625L5.71875 4.875C5.40625 5.28125 5.25 5.78125 5.25 6.28125C5.25 6.90625 5.5 7.5 5.9375 7.9375L6.34375 8.375C6.59375 8.625 6.75 8.96875 6.75 9.34375C6.75 10.0938 6.125 10.6875 5.375 10.6875C4.59375 10.6875 4 10.0938 4 9.3125V7.9375C4 7.75 3.84375 7.59375 3.65625 7.59375C3.53125 7.59375 3.4375 7.65625 3.375 7.71875L3.15625 7.96875C2.71875 8.46875 2.5 9.09375 2.5 9.75V10C2.5 11.9375 4.0625 13.5 6 13.5H6.09375C7.96875 13.5 9.5 12 9.5 10.0938C9.5 9.125 9.09375 8.21875 8.40625 7.53125L6.78125 5.9375C6.59375 5.75 6.5 5.46875 6.5 5.21875V4.84375C6.5 4.65625 6.34375 4.5 6.15625 4.5C6.0625 4.5 5.9375 4.5625 5.875 4.65625Z"/></svg><span>Tickets selling fast</span></div>

      <!-- Inline CTA (hidden, sticky handles it) -->
      <button class="cta-primary" id="cta-inline"></button>
    </div>

    <div class="help-section">
      <div class="section-header">
        <img src="img/fa-circle-question.svg" alt="">
        <h2>Need help?</h2>
      </div>
      <div class="help-content">
        Contact Support <a href="javascript:void(0)">here</a>.
      </div>
    </div>

    <div class="section-header">
      <img src="img/fa-location-dot.svg" alt="">
      <h2>Getting there</h2>
    </div>
    <div class="location">
      <div class="loc-name">Baqueira Beret Ski Resort</div>
      <div class="loc-address">Baqueira Beret Parking Lot, 25598</div>
      <div class="map-placeholder"><img src="img/map-baqueira.png" alt="Map area Baqueira – Estación de Esquí Baqueira Beret"></div>
    </div>

    <div class="footer">
      <div class="footer-cols">
        <div class="footer-col"><h5>About Fever</h5><ul><li><a href="press.html">Press</a></li><li><a href="careers.html">Careers</a></li><li><a href="gift-cards.html">Gift Cards</a></li><li><a href="help-center.html">Help Center</a></li></ul></div>
        <div class="footer-col"><h5>Partner with us</h5><ul><li><a href="fever-zone.html">Fever Zone</a></li><li><a href="list-event.html">List your event</a></li><li><a href="affiliate.html">Affiliate Program</a></li></ul></div>
      </div>
      <div class="legal"><a href="terms.html">Terms of Use</a> | <a href="privacy.html">Privacy Policy</a> | <a href="cookies.html">Cookie Policy</a><div style="margin-top:8px;text-align:right;">&copy;2026 &ndash; Fever</div></div>
    </div>

    <!-- Sticky CTA: "Select hotels" → scroll; then "Skip" or "€X — Add it" -->
    <div class="sticky-cta">
      <button class="cta-btn" id="sticky-btn">Select hotel</button>
    </div>

    <!-- Cross-sell bottom sheet (Option H): offer transportation after accommodation -->
    <div class="crosssell-overlay" id="crosssell-overlay"></div>
    <div class="crosssell-sheet" id="crosssell-sheet">
      <div class="handle"></div>
      <h3>Anything else?</h3>
      <div class="hub-actions">
        <button type="button" class="hub-btn secondary" id="crosssell-yes"><svg viewBox="0 0 24 24"><rect x="3" y="6" width="18" height="12" rx="2"/><path d="M3 10h18"/><circle cx="7.5" cy="15.5" r="1.5"/><circle cx="16.5" cy="15.5" r="1.5"/></svg> Add transport</button>
        <button type="button" class="hub-btn primary" id="crosssell-no">Skip transport</button>
      </div>
    </div>

    <!-- Sequential "Keep buying?" sheet for c1/c2 flows -->
    <div class="crosssell-overlay" id="continue-overlay"></div>
    <div class="crosssell-sheet" id="continue-sheet">
      <div class="handle"></div>
      <h3>Anything else?</h3>
      <div class="hub-actions">
        <button type="button" class="hub-btn secondary" id="continue-keep">Keep shopping</button>
        <button type="button" class="hub-btn primary" id="continue-checkout">Checkout</button>
      </div>
    </div>
  </div>

  <!-- Fullscreen Gallery Overlay -->
  <div class="fs-gallery" id="fsGallery">
    <div class="fs-gallery-topbar">
      <button type="button" class="fs-gallery-close" id="fsGalleryClose" aria-label="Close gallery"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
    </div>
    <div class="fs-gallery-viewport" id="fsGalleryViewport">
      <div class="fs-gallery-track" id="fsGalleryTrack"></div>
      <button type="button" class="fs-gallery-arrow prev" id="fsGalleryPrev" aria-label="Previous"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg></button>
      <button type="button" class="fs-gallery-arrow next" id="fsGalleryNext" aria-label="Next"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 6 15 12 9 18"/></svg></button>
    </div>
    <div class="fs-gallery-thumbs" id="fsGalleryThumbs"></div>
  </div>

  <script src="js/burger-menu.js"></script>
  <script>
    const params = new URLSearchParams(window.location.search);
    let flow = params.get('flow');
    let storedFlow = null;
    try { storedFlow = sessionStorage.getItem('polar_flow_mode'); } catch (e) {}
    if (!flow && (storedFlow === 'c1' || storedFlow === 'c2' || storedFlow === 'd1' || storedFlow === 'd2' || storedFlow === 'e1' || storedFlow === 'e2')) flow = storedFlow;
    const isOptionE = flow === 'c1';
    const isOptionF = flow === 'c2' || flow === 'd1';
    const isOptionG = flow === 'd2';
    const isOptionH = flow === 'e1';
    const isOptionI = flow === 'e2';
    const isSequentialFlow = (flow === 'c1' || flow === 'c2');
    const isHubFlow = (!isSequentialFlow) && (isOptionF || isOptionG || isOptionH || isOptionI);
    const isCrossSellFlow = isOptionH || isOptionI;
    const isOptionalFlow = isSequentialFlow || isHubFlow;
    if (isOptionalFlow) {
      try { sessionStorage.setItem('polar_flow_mode', flow); } catch (e) {}
    }
    if (isOptionalFlow) {
      var accommodationLogoLink = document.getElementById('nav-logo-link');
      if (accommodationLogoLink) accommodationLogoLink.href = flow + '/';
      // Hide stepper for all optional flows EXCEPT e1/i (cross-sell shows dynamic stepper)
      if (!isCrossSellFlow) {
        var accommodationStepper = document.querySelector('.flow-stepper');
        if (accommodationStepper) accommodationStepper.style.display = 'none';
      }
      var step1 = document.getElementById('stepper-step1');
      var step3 = document.getElementById('stepper-step3');
      var step4 = document.getElementById('stepper-step4');
      if (step1) step1.href = 'polar-sound.html?flow=' + flow + '#ticket-section';
      if (step3) step3.href = 'polar-sound-transportations.html?flow=' + flow;
      if (step4) step4.href = 'checkout.html?flow=' + flow;
    }

    // e1/e2: hide stepper (no progress indicator for these flows)
    if (isCrossSellFlow) {
      var stepperEl = document.querySelector('.flow-stepper');
      if (stepperEl) stepperEl.style.display = 'none';
    }

    document.getElementById('sticky-btn').textContent = 'Select hotels';

    // ========== DATA ==========
    const DATA = {
      "2": {
        "3": {
          "hotel": {
            "AC": [
              { name: "Double Room", price: 559.70 },
            ],
            "Meli\u00e1 De tredos": [
              { name: "Double Room", price: 620.00 },
              { name: "Junior Suite", price: 890.00 },
            ]
          },
          "apartamento": {
            "Apartamentos Naut Aran": [
              { name: "Studio (2 pax)", price: 480.00 },
            ],
            "Garona": [
              { name: "1-Bedroom Apartment", price: 520.00 },
            ]
          }
        },
        "2": {
          "hotel": {
            "AC": [
              { name: "Double Room", price: 420.50 },
            ],
            "Meli\u00e1 De tredos": [
              { name: "Double Room", price: 480.00 },
            ]
          },
          "apartamento": {
            "Apartamentos Naut Aran": [
              { name: "Studio (2 pax)", price: 360.00 },
            ]
          }
        }
      },
      "3": {
        "3": {
          "hotel": {
            "Tuc Blanc": [
              { name: "Double Room + 1 extra bed", price: 422.60 },
              { name: "Double Room + 1 extra bed - Deal", price: 428.60, soldout: true },
            ],
            "Garona": [
              { name: "Triple", price: 510.00 },
            ]
          },
          "apartamento": {
            "Apartamentos Naut Aran": [
              { name: "1-Bedroom Apartment + extra bed", price: 540.00 },
            ]
          }
        },
        "2": {
          "hotel": {
            "Tuc Blanc": [
              { name: "Double Room + 1 extra bed", price: 340.00 },
            ],
            "Garona": [
              { name: "Triple", price: 390.00 },
            ]
          },
          "apartamento": {
            "Apartamentos Naut Aran": [
              { name: "1-Bedroom Apartment + extra bed", price: 420.00 },
            ]
          }
        }
      },
      "4": {
        "3": {
          "hotel": {
            "AC": [
              { name: "2x Double Room", price: 559.70 },
            ],
            "Meli\u00e1 De tredos": [
              { name: "Family Suite", price: 980.00 },
            ]
          },
          "apartamento": {
            "Apartamentos Naut Aran": [
              { name: "2-Bedroom Apartment", price: 680.00 },
            ],
            "Garona": [
              { name: "2-Bedroom Apartment", price: 720.00 },
            ]
          }
        },
        "2": {
          "hotel": {
            "AC": [
              { name: "2x Double Room", price: 420.50 },
            ]
          },
          "apartamento": {
            "Apartamentos Naut Aran": [
              { name: "2-Bedroom Apartment", price: 520.00 },
            ]
          }
        }
      }
    };

    // ========== STATE ==========
    let state = { travelers: "2", nights: "3", type: "hotel", name: null };
    let roomCounts = {};

    // ========== ELEMENTS ==========
    const stickyBtn = document.getElementById('sticky-btn');
    const ticketSection = document.getElementById('ticket-section');
    const levelName = document.getElementById('level-name');
    const roomRowsEl = document.getElementById('room-rows');
    let stickyMode = 'tickets';
    let hasSeenTickets = false; // once true, CTA stays as "Add it" permanently

    // ========== STICKY CTA ==========
    const obs = new IntersectionObserver((entries) => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          hasSeenTickets = true;
          stickyMode = 'getit';
          updateSticky();
        } else if (!hasSeenTickets) {
          stickyMode = 'tickets';
          stickyBtn.textContent = 'Select hotel';
        } else {
          stickyMode = 'getit';
          updateSticky();
        }
      });
    }, { threshold: 0.1 });
    obs.observe(ticketSection);

    function getStickyTopOffset() {
      var stickyHeader = document.querySelector('.sticky-header');
      var offset = 0;
      if (stickyHeader && getComputedStyle(stickyHeader).display !== 'none') offset += stickyHeader.offsetHeight;
      return offset;
    }

    function scrollToTicketSection(behavior) {
      var y = ticketSection.getBoundingClientRect().top + window.pageYOffset - getStickyTopOffset();
      window.scrollTo({ top: Math.max(0, y), behavior: behavior || 'auto' });
    }

    stickyBtn.addEventListener('click', () => {
      if (stickyMode === 'tickets') {
        scrollToTicketSection('smooth');
      } else {
        if (getTotal() > 0) {
          saveAccommodationToCart();
        } else {
          localStorage.setItem('cart_accommodation', '[]');
        }

        // Sequential c1/c2: show "Keep buying?" sheet to offer transport
        if (isSequentialFlow) {
          openContinueSheet();
          return;
        }

        // Option H/I: show cross-sell bottom sheet if user came from hub (not from transportation)
        if (isCrossSellFlow) {
          var cameFrom = '';
          try { cameFrom = sessionStorage.getItem('option_h_came_from') || ''; } catch(e) {}
          if (cameFrom !== 'transportation') {
            openCrossSellSheet();
            return;
          }
        }

        var nextUrl;
        if (isOptionI) {
          nextUrl = 'cart.html?flow=e2';
        } else if (isOptionG) {
          nextUrl = 'cart.html?flow=d2';
        } else if (isOptionH) {
          nextUrl = 'checkout.html?flow=e1';
        } else if (isOptionF) {
          nextUrl = 'checkout.html?flow=' + flow;
        } else {
          nextUrl = 'polar-sound-transportations.html' + (flow ? '?flow=' + flow : '');
        }
        if (isHubFlow) {
          if (isCrossSellFlow) {
            var cameFromForClear = '';
            try { cameFromForClear = sessionStorage.getItem('option_h_came_from') || ''; } catch(e) {}
            if (cameFromForClear !== 'transportation') {
              try { localStorage.setItem('cart_transportation', '[]'); } catch (e) {}
            }
          } else if (!isOptionG) {
            try { localStorage.setItem('cart_transportation', '[]'); } catch (e) {}
          }
        }
        try { sessionStorage.setItem('polar_step_nav', '1'); } catch(e) {}
        window.location.href = nextUrl;
      }
    });

    function buildAccommodationCart() {
      var rooms = getCurrentRooms();
      var cartAccommodation = [];
      var travelLabel = document.querySelector('#level-travelers .ticket-pill.active')?.textContent || '';
      var nightsLabel = document.querySelector('#level-nights .ticket-pill.active')?.textContent || '';
      var hotelName = state.name || '';
      rooms.forEach(function(room, i) {
        var qty = roomCounts[i] || 0;
        if (qty > 0 && !room.soldout) {
          cartAccommodation.push({
            name: room.name + ' — ' + hotelName,
            detail: travelLabel + ', ' + nightsLabel,
            price: room.price,
            qty: qty
          });
        }
      });
      return cartAccommodation;
    }

    function saveAccommodationToCart() {
      localStorage.setItem('cart_accommodation', JSON.stringify(buildAccommodationCart()));
    }

    function saveAccommodationSelection() {
      localStorage.setItem('polar_sel_accommodation', JSON.stringify(buildAccommodationCart()));
    }

    function updateSticky() {
      if (stickyMode !== 'getit') return;
      const total = getTotal();
      if (total > 0) {
        stickyBtn.textContent = '\u20AC' + total.toFixed(2) + ' \u2014 Add it';
      } else {
        stickyBtn.textContent = 'Skip hotel';
      }
    }

    function formatPrice(n) {
      return n.toFixed(2);
    }

    function getTotal() {
      let total = 0;
      const rooms = getCurrentRooms();
      rooms.forEach((r, i) => {
        if (!r.soldout) total += (roomCounts[i] || 0) * r.price;
      });
      return total;
    }

    // ========== DATA LOOKUP ==========
    function getNames() {
      const d = DATA[state.travelers]?.[state.nights]?.[state.type];
      return d ? Object.keys(d) : [];
    }

    function getCurrentRooms() {
      if (!state.name) return [];
      return DATA[state.travelers]?.[state.nights]?.[state.type]?.[state.name] || [];
    }

    // ========== RENDER ==========
    function renderNamePills() {
      const names = getNames();
      // Clear existing pills (keep arrows)
      const arrows = levelName.querySelectorAll('.pill-arrow');
      levelName.innerHTML = '';
      if (arrows[0]) levelName.appendChild(arrows[0]);

      if (names.length === 0) { state.name = null; renderRooms(); return; }
      if (!names.includes(state.name)) state.name = names[0];

      names.forEach(n => {
        const pill = document.createElement('div');
        pill.className = 'ticket-pill' + (n === state.name ? ' active' : '');
        pill.textContent = n;
        pill.addEventListener('click', () => {
          state.name = n;
          roomCounts = {};
          renderNamePills();
        });
        levelName.appendChild(pill);
      });

      // Right arrow
      const rightArrow = document.createElement('div');
      rightArrow.className = 'pill-arrow';
      rightArrow.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>';
      levelName.appendChild(rightArrow);

      renderRooms();
      if (typeof updatePillsArrows === 'function') updatePillsArrows();
    }

    function renderRooms() {
      roomRowsEl.innerHTML = '';
      const rooms = getCurrentRooms();

      rooms.forEach((room, i) => {
        if (!(i in roomCounts)) roomCounts[i] = 0;

        const row = document.createElement('div');
        row.className = 'ticket-row' + (room.soldout ? ' soldout' : '') + (roomCounts[i] > 0 ? ' selected' : '');

        row.innerHTML = `
          <div class="ticket-content">
            <div class="ticket-name">${room.name}</div>
            <button type="button" class="ticket-info-toggle" aria-expanded="false">More info</button>
            <div class="ticket-info-detail">
              <div class="ticket-info-intro">Hotel stay for your trip, includes:</div>
              <ul>
                <li>2-day festival pass (access to both days)</li>
                <li>Check-in from 15:00, check-out before 12:00</li>
                <li>Free cancellation until 48h before arrival</li>
              </ul>
            </div>
            <div class="ticket-price">\u20AC${formatPrice(room.price)}</div>
          </div>
          <span class="soldout-tag">Sold out</span>
          <div class="ticket-notch"><span class="notch-line"></span></div>
          <div class="ticket-selector-right">
            <div class="stepper ticket-amount">
              <button class="amt-btn minus">\u2212</button>
              <span class="amt-count">${roomCounts[i]}</span>
              <button class="amt-btn plus">+</button>
            </div>
          </div>
        `;

        if (!room.soldout) {
          row.querySelector('.amt-btn.plus').addEventListener('click', () => {
            roomCounts[i]++;
            saveAccommodationSelection();
            renderRooms();
          });
          row.querySelector('.amt-btn.minus').addEventListener('click', () => {
            if (roomCounts[i] > 0) roomCounts[i]--;
            saveAccommodationSelection();
            renderRooms();
          });
        }

        roomRowsEl.appendChild(row);
      });

      // More info / Less info toggle (same as tickets PV)
      roomRowsEl.querySelectorAll('.ticket-info-toggle').forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          const row = this.closest('.ticket-row');
          const expanded = row.classList.toggle('ticket-info-expanded');
          this.textContent = expanded ? 'Less info' : 'More info';
          this.setAttribute('aria-expanded', expanded);
        });
      });

      updateSticky();
    }

    // ========== PILL EVENTS ==========
    function setupLevel(id, stateKey) {
      const level = document.getElementById(id);
      level.querySelectorAll('.ticket-pill').forEach(pill => {
        pill.addEventListener('click', () => {
          level.querySelectorAll('.ticket-pill').forEach(p => p.classList.remove('active'));
          pill.classList.add('active');
          state[stateKey] = pill.dataset.value;
          roomCounts = {};
          state.name = null;
          renderNamePills();
        });
      });
    }

    setupLevel('level-travelers', 'travelers');
    setupLevel('level-nights', 'nights');
    // Center pills when they fit; show arrow when they overflow. Enable swipe when overflow.
    function updatePillsArrows() {
      document.querySelectorAll('.pill-level').forEach(level => {
        const overflows = level.scrollWidth > level.clientWidth;
        level.classList.toggle('centered', !overflows);
        const arrow = level.querySelector('.pill-arrow');
        if (arrow) arrow.classList.toggle('visible', overflows);
      });
    }

    // Check nav token: if absent (refresh / direct entry), clear step selections
    (function() {
      if (!flow || flow === 'a1' || flow === 'a2') {
        var token = null;
        try { token = sessionStorage.getItem('polar_step_nav'); } catch(e) {}
        if (token) {
          try { sessionStorage.removeItem('polar_step_nav'); } catch(e) {}
        } else {
          try { localStorage.removeItem('cart_accommodation'); } catch(e) {}
          try { localStorage.removeItem('cart_transportation'); } catch(e) {}
          try { localStorage.removeItem('polar_sel_accommodation'); } catch(e) {}
          try { localStorage.removeItem('polar_sel_transportation'); } catch(e) {}
        }
      }
    })();

    // Set nav token before any stepper link click
    document.querySelectorAll('.flow-stepper a.step').forEach(function(link) {
      link.addEventListener('click', function() {
        try { sessionStorage.setItem('polar_step_nav', '1'); } catch(e) {}
      });
    });

    // c1/c2 sequential: clear any previous selections so page starts fresh
    if (flow === 'c1' || flow === 'c2') {
      try { localStorage.removeItem('polar_sel_accommodation'); } catch(e) {}
      try { localStorage.removeItem('cart_accommodation'); } catch(e) {}
    }

    // Restore accommodation selections (visual persistence across step navigation)
    (function restoreAccommodationSelection() {
      try {
        var saved = JSON.parse(localStorage.getItem('polar_sel_accommodation') || '[]');
        if (!Array.isArray(saved) || saved.length === 0) {
          saved = JSON.parse(localStorage.getItem('cart_accommodation') || '[]');
        }
        if (!Array.isArray(saved) || saved.length === 0) return;
        var first = saved[0];
        if (!first || !first.detail || !first.name) return;
        // Parse travelers from detail: "Trip 2 people + Pass, 3 nights ..."
        var travMatch = first.detail.match(/Trip\s+(\d+)/);
        if (travMatch) state.travelers = travMatch[1];
        // Parse nights from detail: "..., 3 nights ..."
        var nightMatch = first.detail.match(/(\d+)\s+night/);
        if (nightMatch) state.nights = nightMatch[1];
        // Parse hotel name from item name: "Room Name — Hotel Name"
        var dashIdx = first.name.indexOf(' \u2014 ');
        if (dashIdx === -1) dashIdx = first.name.indexOf(' — ');
        if (dashIdx !== -1) state.name = first.name.substring(dashIdx + 3);
        // Activate the correct travelers pill
        document.querySelectorAll('#level-travelers .ticket-pill').forEach(function(p) {
          p.classList.toggle('active', p.dataset.value === state.travelers);
        });
        // Activate the correct nights pill
        document.querySelectorAll('#level-nights .ticket-pill').forEach(function(p) {
          p.classList.toggle('active', p.dataset.value === state.nights);
        });
        // Pre-populate roomCounts by matching room name and price
        var rooms = (DATA[state.travelers] && DATA[state.travelers][state.nights] && DATA[state.travelers][state.nights][state.type] && DATA[state.travelers][state.nights][state.type][state.name]) || [];
        roomCounts = {};
        rooms.forEach(function(room, i) {
          saved.forEach(function(item) {
            if (item.price === room.price && item.name && item.name.indexOf(room.name) === 0) {
              roomCounts[i] = item.qty || 0;
            }
          });
        });
        hasSeenTickets = true;
        stickyMode = 'getit';
      } catch (e) {}
    })();

    // Initial render
    renderNamePills();

    renderRooms();

    // c1/c2/d1/d2: show "Skip hotel" CTA immediately (no pre-selection)
    if (flow === 'c1' || flow === 'c2' || flow === 'd1' || flow === 'd2') {
      hasSeenTickets = true;
      stickyMode = 'getit';
      updateSticky();
    }

    // Selections are auto-saved on every count change, so navigating
    // to Transport via stepper preserves the user's hotel choices.

    updatePillsArrows();
    window.addEventListener('resize', updatePillsArrows);

    // Scroll to ticket selector on load without animation (no visible autoscroll from hero).
    // Temporarily override CSS scroll-behavior:smooth so the jump is instant.
    function scrollAccommodationToSelector() {
      if (!ticketSection) return;
      document.documentElement.style.scrollBehavior = 'auto';
      requestAnimationFrame(function() {
        scrollToTicketSection('auto');
        setTimeout(function() {
          scrollToTicketSection('auto');
          document.documentElement.style.scrollBehavior = '';
        }, 120);
      });
    }
    scrollAccommodationToSelector();
    window.addEventListener('pageshow', scrollAccommodationToSelector);

    // Flow a1 (default): show "Skip hotel" / "Add it" CTA immediately.
    // If restoreAccommodationFromCart() already set stickyMode, this just ensures
    // hasSeenTickets is true so the CTA doesn't show "Select date and session".
    if (!flow || flow === 'a1') {
      hasSeenTickets = true;
      stickyMode = 'getit';
      updateSticky();
    }

    (function() {
      var tickets = [];
      try { tickets = JSON.parse(localStorage.getItem('cart_tickets') || '[]'); } catch (e) {}
      var hasTickets = tickets.length > 0 && tickets.some(function(t) { return (t.qty || 0) > 0; });
      if (!hasTickets) document.getElementById('stepper-step1') && document.getElementById('stepper-step1').classList.add('skipped');
    })();

    // === Cross-sell bottom sheet (Option H) ===
    function openCrossSellSheet() {
      var overlay = document.getElementById('crosssell-overlay');
      var sheet = document.getElementById('crosssell-sheet');
      if (overlay) overlay.classList.add('open');
      if (sheet) sheet.classList.add('open');
      document.body.style.overflow = 'hidden';
    }
    function closeCrossSellSheet() {
      var overlay = document.getElementById('crosssell-overlay');
      var sheet = document.getElementById('crosssell-sheet');
      if (sheet) sheet.style.transform = '';
      if (overlay) overlay.classList.remove('open');
      if (sheet) sheet.classList.remove('open');
      document.body.style.overflow = '';
    }
    (function bindCrossSell() {
      var overlay = document.getElementById('crosssell-overlay');
      var btnYes = document.getElementById('crosssell-yes');
      var btnNo = document.getElementById('crosssell-no');
      if (overlay) overlay.addEventListener('click', closeCrossSellSheet);
      if (btnYes) {
        btnYes.addEventListener('click', function() {
          try { sessionStorage.setItem('option_h_came_from', 'accommodation'); } catch(e) {}
          window.location.href = 'polar-sound-transportations.html?flow=' + flow;
        });
      }
      if (btnNo) {
        btnNo.addEventListener('click', function() {
          try { localStorage.setItem('cart_transportation', '[]'); } catch(e) {}
          var noDest = isOptionI ? 'cart.html?flow=e2' : 'checkout.html?flow=e1';
          window.location.href = noDest;
        });
      }
    })();
    // Swipe-to-dismiss for cross-sell sheet
    (function() {
      var sheetEl = document.getElementById('crosssell-sheet');
      if (!sheetEl) return;
      var startY = 0, currentY = 0, isDragging = false;
      function dragStart(y) { startY = y; currentY = y; isDragging = true; sheetEl.style.transition = 'none'; }
      function dragMove(y, e) { if (!isDragging) return; currentY = y; var dy = currentY - startY; if (dy < 0) dy = 0; if (dy > 0) { if (e) e.preventDefault(); sheetEl.style.transform = 'translateX(-50%) translateY(' + dy + 'px)'; } }
      function dragEnd() { if (!isDragging) return; isDragging = false; sheetEl.style.transition = ''; sheetEl.style.transform = ''; if (currentY - startY > 80) closeCrossSellSheet(); }
      sheetEl.addEventListener('touchstart', function(e) { dragStart(e.touches[0].clientY); }, { passive: true });
      sheetEl.addEventListener('touchmove', function(e) { dragMove(e.touches[0].clientY, e); }, { passive: false });
      sheetEl.addEventListener('touchend', dragEnd);
      sheetEl.addEventListener('mousedown', function(e) { e.preventDefault(); dragStart(e.clientY); });
      document.addEventListener('mousemove', function(e) { if (isDragging) dragMove(e.clientY, e); });
      document.addEventListener('mouseup', dragEnd);
    })();

    // === Sequential "Keep buying?" sheet for c1/c2 flows ===
    function openContinueSheet() {
      var overlay = document.getElementById('continue-overlay');
      var sheet = document.getElementById('continue-sheet');
      if (overlay) overlay.classList.add('open');
      if (sheet) sheet.classList.add('open');
      document.body.style.overflow = 'hidden';
    }
    function closeContinueSheet() {
      var overlay = document.getElementById('continue-overlay');
      var sheet = document.getElementById('continue-sheet');
      if (sheet) sheet.style.transform = '';
      if (overlay) overlay.classList.remove('open');
      if (sheet) sheet.classList.remove('open');
      document.body.style.overflow = '';
    }
    (function bindContinueSheet() {
      var overlay = document.getElementById('continue-overlay');
      var btnKeep = document.getElementById('continue-keep');
      var btnCheckout = document.getElementById('continue-checkout');
      if (overlay) overlay.addEventListener('click', closeContinueSheet);
      if (btnKeep) {
        btnKeep.addEventListener('click', function() {
          window.location.href = 'polar-sound-transportations.html?flow=' + flow;
        });
      }
      if (btnCheckout) {
        btnCheckout.addEventListener('click', function() {
          try { localStorage.setItem('cart_transportation', '[]'); } catch (e) {}
          var dest = (flow === 'c2') ? 'cart.html?flow=' + flow : 'checkout.html?flow=' + flow;
          window.location.href = dest;
        });
      }
    })();
    (function() {
      var sheetEl = document.getElementById('continue-sheet');
      if (!sheetEl) return;
      var startY = 0, currentY = 0, isDragging = false;
      function dragStart(y) { startY = y; currentY = y; isDragging = true; sheetEl.style.transition = 'none'; }
      function dragMove(y, e) { if (!isDragging) return; currentY = y; var dy = currentY - startY; if (dy < 0) dy = 0; if (dy > 0) { if (e) e.preventDefault(); sheetEl.style.transform = 'translateX(-50%) translateY(' + dy + 'px)'; } }
      function dragEnd() { if (!isDragging) return; isDragging = false; sheetEl.style.transition = ''; sheetEl.style.transform = ''; if (currentY - startY > 80) closeContinueSheet(); }
      sheetEl.addEventListener('touchstart', function(e) { dragStart(e.touches[0].clientY); }, { passive: true });
      sheetEl.addEventListener('touchmove', function(e) { dragMove(e.touches[0].clientY, e); }, { passive: false });
      sheetEl.addEventListener('touchend', dragEnd);
      sheetEl.addEventListener('mousedown', function(e) { e.preventDefault(); dragStart(e.clientY); });
      document.addEventListener('mousemove', function(e) { if (isDragging) dragMove(e.clientY, e); });
      document.addEventListener('mouseup', dragEnd);
    })();
  </script>
  <script>
    (function(){
      var FAVORITES_KEY='polar_liked_plans';
      var likeBtn=document.querySelector('.side-btn[aria-label="Like"]');
      if(!likeBtn)return;
      function readFav(){try{var r=localStorage.getItem(FAVORITES_KEY);var p=r?JSON.parse(r):{};return p&&typeof p==='object'?p:{};}catch(e){return {};}}
      function writeFav(f){try{localStorage.setItem(FAVORITES_KEY,JSON.stringify(f));}catch(e){}}
      var titleNode=document.querySelector('.title-section h1');
      var heroImg=document.querySelector('.carousel-slide img')||document.querySelector('.hero-bg')||document.querySelector('.hero img');
      var planTitle=titleNode?titleNode.textContent.trim():document.title;
      var planImage=heroImg?heroImg.src:'';
      var planHref=window.location.href.split('?')[0].split('#')[0];
      var slug='polar-sound';
      var planId='plan-view::'+slug;
      var fav=readFav();
      if(fav[planId]){likeBtn.classList.add('liked');likeBtn.setAttribute('aria-label','Remove from favorites');}
      likeBtn.addEventListener('click',function(e){
        e.preventDefault();e.stopPropagation();
        var isLiked=likeBtn.classList.toggle('liked');
        fav=readFav();
        if(isLiked){
          fav[planId]={id:planId,title:planTitle,meta:'',price:'',badge:'',href:planHref,image:planImage};
          likeBtn.setAttribute('aria-label','Remove from favorites');
        }else{
          delete fav[planId];
          likeBtn.setAttribute('aria-label','Like');
        }
        writeFav(fav);
      });
    })();
  </script>
<script>if(localStorage.getItem('fever_logged_in')==='true'){document.documentElement.classList.add('u-in');var a=document.querySelector('.avatar-wrap');if(a){a.href='profile.html';}}</script>
  <script>
  (function() {
    var fsGallery = document.getElementById('fsGallery');
    var fsTrack = document.getElementById('fsGalleryTrack');
    var fsThumbs = document.getElementById('fsGalleryThumbs');
    var fsClose = document.getElementById('fsGalleryClose');
    var fsViewport = document.getElementById('fsGalleryViewport');
    var fsPrev = document.getElementById('fsGalleryPrev');
    var fsNext = document.getElementById('fsGalleryNext');
    var galleryBtn = document.querySelector('.gallery-btn');
    if (!fsGallery || !galleryBtn) return;

    var images = [];
    var fsCurrent = 0;
    var fsTouchStartX = 0, fsTouchStartY = 0, fsSwiping = false;

    function collectImages() {
      images = [];
      var carouselImgs = document.querySelectorAll('.carousel-slide img');
      if (carouselImgs.length) {
        carouselImgs.forEach(function(img) {
          if (img.src && !img.closest('.carousel-slide').classList.contains('clone-slide')) images.push(img.src);
        });
      } else {
        var heroImg = document.querySelector('.hero-bg') || document.querySelector('.hero img');
        if (heroImg && heroImg.src) images.push(heroImg.src);
      }
    }

    function buildSlides() {
      fsTrack.innerHTML = '';
      fsThumbs.innerHTML = '';
      images.forEach(function(src, i) {
        var slide = document.createElement('div');
        slide.className = 'fs-gallery-slide';
        var img = document.createElement('img');
        img.src = src; img.alt = 'Photo ' + (i + 1); img.draggable = false;
        slide.appendChild(img);
        fsTrack.appendChild(slide);
        var thumb = document.createElement('div');
        thumb.className = 'fs-gallery-thumb' + (i === 0 ? ' active' : '');
        var tImg = document.createElement('img');
        tImg.src = src; tImg.alt = 'Thumbnail ' + (i + 1);
        thumb.appendChild(tImg);
        thumb.addEventListener('click', (function(idx) { return function() { fsGoTo(idx); }; })(i));
        fsThumbs.appendChild(thumb);
      });
    }

    function scrollThumbIntoView(idx) {
      var th = fsThumbs.children[idx];
      if (!th) return;
      fsThumbs.scrollTo({ left: th.offsetLeft - fsThumbs.offsetWidth / 2 + th.offsetWidth / 2, behavior: 'smooth' });
    }

    function updateArrows() {
      fsPrev.style.display = fsCurrent <= 0 ? 'none' : '';
      fsNext.style.display = fsCurrent >= images.length - 1 ? 'none' : '';
    }

    function fsGoTo(idx) {
      if (idx < 0) idx = 0;
      if (idx >= images.length) idx = images.length - 1;
      fsCurrent = idx;
      fsTrack.style.transform = 'translateX(-' + (idx * 100) + '%)';
      fsThumbs.querySelectorAll('.fs-gallery-thumb').forEach(function(t, i) { t.classList.toggle('active', i === idx); });
      scrollThumbIntoView(idx);
      updateArrows();
    }

    function openGallery() {
      collectImages();
      if (!images.length) return;
      buildSlides();
      fsGoTo(0);
      fsGallery.classList.add('open');
      document.body.style.overflow = 'hidden';
    }

    function closeGallery() {
      fsGallery.classList.remove('open');
      document.body.style.overflow = '';
    }

    galleryBtn.addEventListener('click', function(e) { e.preventDefault(); openGallery(); });
    fsClose.addEventListener('click', closeGallery);
    fsPrev.addEventListener('click', function() { fsGoTo(fsCurrent - 1); });
    fsNext.addEventListener('click', function() { fsGoTo(fsCurrent + 1); });
    fsGallery.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') closeGallery();
      if (e.key === 'ArrowRight') fsGoTo(fsCurrent + 1);
      if (e.key === 'ArrowLeft') fsGoTo(fsCurrent - 1);
    });
    fsViewport.addEventListener('touchstart', function(e) { fsTouchStartX = e.touches[0].clientX; fsTouchStartY = e.touches[0].clientY; fsSwiping = false; fsTrack.classList.add('no-transition'); }, { passive: true });
    fsViewport.addEventListener('touchmove', function(e) {
      var dx = e.touches[0].clientX - fsTouchStartX;
      var dy = e.touches[0].clientY - fsTouchStartY;
      if (!fsSwiping && Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > 8) fsSwiping = true;
      if (fsSwiping) { e.preventDefault(); fsTrack.style.transform = 'translateX(' + (-(fsCurrent * 100) + (dx / fsViewport.offsetWidth) * 100) + '%)'; }
    }, { passive: false });
    fsViewport.addEventListener('touchend', function(e) {
      fsTrack.classList.remove('no-transition');
      if (!fsSwiping) return;
      var dx = e.changedTouches[0].clientX - fsTouchStartX;
      if (dx < -50 && fsCurrent < images.length - 1) fsGoTo(fsCurrent + 1);
      else if (dx > 50 && fsCurrent > 0) fsGoTo(fsCurrent - 1);
      else fsGoTo(fsCurrent);
    });
  })();
  </script>
  <script src="js/recently-viewed.js"></script>
  <script src="js/flow-param.js"></script>
</body>
</html>
